(function(e){'use strict';e.sessionTimeout=function(i){var l={title:'Your Session is About to Expire!',message:'Your session is about to expire.',logoutButton:'Logout',keepAliveButton:'Stay Connected',keepAliveUrl:'/keep-alive',ajaxType:'POST',ajaxData:'',redirUrl:'/timed-out',logoutUrl:'/log-out',warnAfter:900000,redirAfter:1200000,keepAliveInterval:5000,keepAlive:!0,ignoreUserActivity:!1,onStart:!1,onWarn:!1,onRedir:!1,countdownMessage:!1,countdownBar:!1,countdownSmart:!1};var t=l,n,o={};if(i){t=e.extend(l,i)};if(t.warnAfter>=t.redirAfter){console.error('Bootstrap-session-timeout plugin is miss-configured. Option "redirAfter" must be equal or greater than "warnAfter".');return!1};if(typeof t.onWarn!=='function'){var u=t.countdownMessage?'<p>'+t.countdownMessage.replace(/{timer}/g,'<span class="countdown-holder"></span>')+'</p>':'',f=t.countdownBar?'<div class="progress">                   <div class="progress-bar progress-bar-striped countdown-bar active" role="progressbar" style="min-width: 15px; width: 100%;">                     <span class="countdown-holder"></span>                   </div>                 </div>':'';e('body').append('<div class="modal fade" id="session-timeout-dialog">               <div class="modal-dialog">                 <div class="modal-content">                   <div class="modal-header">                     <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>                     <h4 class="modal-title">'+t.title+'</h4>                   </div>                   <div class="modal-body">                     <p>'+t.message+'</p>                     '+u+'                     '+f+'                   </div>                   <div class="modal-footer">                     <button id="session-timeout-dialog-logout" type="button" class="btn btn-default">'+t.logoutButton+'</button>                     <button id="session-timeout-dialog-keepalive" type="button" class="btn btn-primary" data-dismiss="modal">'+t.keepAliveButton+'</button>                   </div>                 </div>               </div>              </div>');e('#session-timeout-dialog-logout').on('click',function(){window.location=t.logoutUrl});e('#session-timeout-dialog').on('hide.bs.modal',function(){d()})};if(!t.ignoreUserActivity){var s=[-1,-1];e(document).on('keyup mouseup mousemove touchend touchmove',function(t){if(t.type==='mousemove'){if(t.clientX===s[0]&&t.clientY===s[1]){return};s[0]=t.clientX;s[1]=t.clientY};d();if(e('#session-timeout-dialog').length>0&&e('#session-timeout-dialog').data('bs.modal')&&e('#session-timeout-dialog').data('bs.modal').isShown){e('#session-timeout-dialog').modal('hide');e('body').removeClass('modal-open');e('div.modal-backdrop').remove()}})};var a=!1;function m(){if(!a){e.ajax({type:t.ajaxType,url:t.keepAliveUrl,data:t.ajaxData});a=!0;setTimeout(function(){a=!1},t.keepAliveInterval)}};function d(){clearTimeout(n);if(t.countdownMessage||t.countdownBar){r('session',!0)};if(typeof t.onStart==='function'){t.onStart(t)};if(t.keepAlive){m()};n=setTimeout(function(){if(typeof t.onWarn!=='function'){e('#session-timeout-dialog').modal('show')}
else{t.onWarn(t)};c()},t.warnAfter)};function c(){clearTimeout(n);if(!e('#session-timeout-dialog').hasClass('in')&&(t.countdownMessage||t.countdownBar)){r('dialog',!0)};n=setTimeout(function(){if(typeof t.onRedir!=='function'){window.location=t.redirUrl}
else{t.onRedir(t)}},(t.redirAfter-t.warnAfter))};function r(i,l){clearTimeout(o.timer);if(i==='dialog'&&l){o.timeLeft=Math.floor((t.redirAfter-t.warnAfter)/1000)}
else if(i==='session'&&l){o.timeLeft=Math.floor(t.redirAfter/1000)};if(t.countdownBar&&i==='dialog'){o.percentLeft=Math.floor(o.timeLeft/((t.redirAfter-t.warnAfter)/1000)*100)}
else if(t.countdownBar&&i==='session'){o.percentLeft=Math.floor(o.timeLeft/(t.redirAfter/1000)*100)};var a=e('.countdown-holder'),s=o.timeLeft>=0?o.timeLeft:0;if(t.countdownSmart){var d=Math.floor(s/60),u=s%60,n=d>0?d+'m':'';if(n.length>0){n+=' '};n+=u+'s';a.text(n)}
else{a.text(s+'s')};if(t.countdownBar){e('.countdown-bar').css('width',o.percentLeft+'%')};o.timeLeft=o.timeLeft-1;o.timer=setTimeout(function(){r(i)},1000)};d()}})(jQuery);