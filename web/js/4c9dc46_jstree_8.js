(function(e){"use strict";if(typeof define==="function"&&define.amd){define(["jquery"],e)}
else if(typeof exports==="object"){e(require("jquery"))}
else{e(jQuery)}}(function(e,i){"use strict";
/*!
 * jsTree 3.0.4
 * http://jstree.com/
 *
 * Copyright (c) 2014 Ivan Bozhanov (http://vakata.com)
 *
 * Licensed same as jquery - under the terms of the MIT License
 *   http://www.opensource.org/licenses/mit-license.php
 */

/*!
 * if using jslint please allow for the jQuery global and use following options: 
 * jslint: browser: true, ass: true, bitwise: true, continue: true, nomen: true, plusplus: true, regexp: true, unparam: true, todo: true, white: true
 */
if(e.jstree){return};var p=0,n=!1,s=!1,o=!1,u=[],f=e("script:last").attr("src"),c=document,d=c.createElement("LI"),r,l;d.setAttribute("role","treeitem");r=c.createElement("I");r.className="jstree-icon jstree-ocl";d.appendChild(r);r=c.createElement("A");r.className="jstree-anchor";r.setAttribute("href","#");l=c.createElement("I");l.className="jstree-icon jstree-themeicon";r.appendChild(l);d.appendChild(r);r=l=null;e.jstree={version:"3.0.4",defaults:{plugins:[]},plugins:{},path:f&&f.indexOf("/")!==-1?f.replace(/\/[^\/]+$/,""):"",idregex:/[\\:&!^|()\[\]<>@*'+~#";.,=\- \/${}%]/g};e.jstree.create=function(t,i){var r=new e.jstree.core(++p),s=i;i=e.extend(!0,{},e.jstree.defaults,i);if(s&&s.plugins){i.plugins=s.plugins};e.each(i.plugins,function(e,t){if(e!=="core"){r=r.plugin(t,i[t])}});r.init(t,i);return r};e.jstree.destroy=function(){e(".jstree:jstree").jstree("destroy");e(document).off(".jstree")};e.jstree.core=function(e){this._id=e;this._cnt=0;this._wrk=null;this._data={core:{themes:{name:!1,dots:!1,icons:!1},selected:[],last_error:{},working:!1,worker_queue:[],focused:null}}};e.jstree.reference=function(t){var s=null,i=null;if(t&&t.id){t=t.id};if(!i||!i.length){try{i=e(t)}catch(r){}};if(!i||!i.length){try{i=e("#"+t.replace(e.jstree.idregex,"\\$&"))}catch(r){}};if(i&&i.length&&(i=i.closest(".jstree")).length&&(i=i.data("jstree"))){s=i}
else{e(".jstree").each(function(){var i=e(this).data("jstree");if(i&&i._model.data[t]){s=i;return!1}})};return s};e.fn.jstree=function(t){var s=(typeof t==="string"),n=Array.prototype.slice.call(arguments,1),r=null;this.each(function(){var a=e.jstree.reference(this),o=s&&a?a[t]:null;r=s&&o?o.apply(a,n):null;if(!a&&!s&&(t===i||e.isPlainObject(t))){e(this).data("jstree",new e.jstree.create(this,t))};if((a&&!s)||t===!0){r=a||!1};if(r!==null&&r!==i){return!1}});return r!==null&&r!==i?r:this};e.expr[":"].jstree=e.expr.createPseudo(function(t){return function(t){return e(t).hasClass("jstree")&&e(t).data("jstree")!==i}});e.jstree.defaults.core={data:!1,strings:!1,check_callback:!1,error:e.noop,animation:200,multiple:!0,themes:{name:!1,url:!1,dir:!1,dots:!0,icons:!0,stripes:!1,variant:!1,responsive:!1},expand_selected_onload:!0,worker:!0,force_text:!1};e.jstree.core.prototype={plugin:function(t,i){var r=e.jstree.plugins[t];if(r){this._data[t]={};r.prototype=this;return new r(i,this)};return this},init:function(t,i){this._model={data:{"#":{id:"#",parent:null,parents:[],children:[],children_d:[],state:{loaded:!1}}},changed:[],force_full_redraw:!1,redraw_timeout:!1,default_state:{loaded:!0,opened:!1,selected:!1,disabled:!1}};this.element=e(t).addClass("jstree jstree-"+this._id);this.settings=i;this.element.bind("destroyed",e.proxy(this.teardown,this));this._data.core.ready=!1;this._data.core.loaded=!1;this._data.core.rtl=(this.element.css("direction")==="rtl");this.element[this._data.core.rtl?"addClass":"removeClass"]("jstree-rtl");this.element.attr("role","tree");this.bind();this.trigger("init");this._data.core.original_container_html=this.element.find(" > ul > li").clone(!0);this._data.core.original_container_html.find("li").addBack().contents().filter(function(){return this.nodeType===3&&(!this.nodeValue||/^\s+$/.test(this.nodeValue))}).remove();this.element.html("<ul class='jstree-container-ul jstree-children'><li class='jstree-initial-node jstree-loading jstree-leaf jstree-last'><i class='jstree-icon jstree-ocl'></i><a class='jstree-anchor' href='#'><i class='jstree-icon jstree-themeicon-hidden'></i>"+this.get_string("Loading ...")+"</a></li></ul>");this._data.core.li_height=this.get_container_ul().children("li:eq(0)").height()||24;this.trigger("loading");this.load_node("#")},destroy:function(e){if(this._wrk){try{window.URL.revokeObjectURL(this._wrk);this._wrk=null}catch(t){}};if(!e){this.element.empty()};this.element.unbind("destroyed",this.teardown);this.teardown()},teardown:function(){this.unbind();this.element.removeClass("jstree").removeData("jstree").find("[class^='jstree']").addBack().attr("class",function(){return this.className.replace(/jstree[^ ]*|$/ig,"")});this.element=null},bind:function(){this.element.on("dblclick.jstree",function(){if(document.selection&&document.selection.empty){document.selection.empty()}
else{if(window.getSelection){var t=window.getSelection();try{t.removeAllRanges();t.collapse()}catch(e){}}}}).on("click.jstree",".jstree-ocl",e.proxy(function(e){this.toggle_node(e.target)},this)).on("click.jstree",".jstree-anchor",e.proxy(function(t){t.preventDefault();if(t.currentTarget!==document.activeElement){e(t.currentTarget).focus()};this.activate_node(t.currentTarget,t)},this)).on("keydown.jstree",".jstree-anchor",e.proxy(function(t){if(t.target.tagName==="INPUT"){return!0};var i=null;switch(t.which){case 13:case 32:t.type="click";e(t.currentTarget).trigger(t);break;case 37:t.preventDefault();if(this.is_open(t.currentTarget)){this.close_node(t.currentTarget)}
else{i=this.get_prev_dom(t.currentTarget);if(i&&i.length){i.children(".jstree-anchor").focus()}};break;case 38:t.preventDefault();i=this.get_prev_dom(t.currentTarget);if(i&&i.length){i.children(".jstree-anchor").focus()};break;case 39:t.preventDefault();if(this.is_closed(t.currentTarget)){this.open_node(t.currentTarget,function(e){this.get_node(e,!0).children(".jstree-anchor").focus()})}
else{i=this.get_next_dom(t.currentTarget);if(i&&i.length){i.children(".jstree-anchor").focus()}};break;case 40:t.preventDefault();i=this.get_next_dom(t.currentTarget);if(i&&i.length){i.children(".jstree-anchor").focus()};break;case 46:t.preventDefault();i=this.get_node(t.currentTarget);if(i&&i.id&&i.id!=="#"){i=this.is_selected(i)?this.get_selected():i};break;case 113:t.preventDefault();i=this.get_node(t.currentTarget);
/*!
								if(o && o.id && o.id == '#') {
									// this.edit(o);
								}
								*/
break;default:break}},this)).on("load_node.jstree",e.proxy(function(t,i){if(i.status){if(i.node.id==="#"&&!this._data.core.loaded){this._data.core.loaded=!0;this.trigger("loaded")};if(!this._data.core.ready&&!this.get_container_ul().find(".jstree-loading:eq(0)").length){this._data.core.ready=!0;if(this._data.core.selected.length){if(this.settings.core.expand_selected_onload){var s=[],r,n;for(r=0,n=this._data.core.selected.length;r<n;r++){s=s.concat(this._model.data[this._data.core.selected[r]].parents)};s=e.vakata.array_unique(s);for(r=0,n=s.length;r<n;r++){this.open_node(s[r],!1,0)}};this.trigger("changed",{"action":"ready","selected":this._data.core.selected})};setTimeout(e.proxy(function(){this.trigger("ready")},this),0)}}},this)).on("init.jstree",e.proxy(function(){var e=this.settings.core.themes;this._data.core.themes.dots=e.dots;this._data.core.themes.stripes=e.stripes;this._data.core.themes.icons=e.icons;this.set_theme(e.name||"default",e.url);this.set_theme_variant(e.variant)},this)).on("loading.jstree",e.proxy(function(){this[this._data.core.themes.dots?"show_dots":"hide_dots"]();this[this._data.core.themes.icons?"show_icons":"hide_icons"]();this[this._data.core.themes.stripes?"show_stripes":"hide_stripes"]()},this)).on("blur.jstree",".jstree-anchor",e.proxy(function(t){this._data.core.focused=null;e(t.currentTarget).filter(".jstree-hovered").mouseleave()},this)).on("focus.jstree",".jstree-anchor",e.proxy(function(t){var i=this.get_node(t.currentTarget);if(i&&i.id){this._data.core.focused=i.id};this.element.find(".jstree-hovered").not(t.currentTarget).mouseleave();e(t.currentTarget).mouseenter()},this)).on("mouseenter.jstree",".jstree-anchor",e.proxy(function(e){this.hover_node(e.currentTarget)},this)).on("mouseleave.jstree",".jstree-anchor",e.proxy(function(e){this.dehover_node(e.currentTarget)},this))},unbind:function(){this.element.off(".jstree");e(document).off(".jstree-"+this._id)},trigger:function(e,t){if(!t){t={}};t.instance=this;this.element.triggerHandler(e.replace(".jstree","")+".jstree",t)},get_container:function(){return this.element},get_container_ul:function(){return this.element.children(".jstree-children:eq(0)")},get_string:function(t){var i=this.settings.core.strings;if(e.isFunction(i)){return i.call(this,t)};if(i&&i[t]){return i[t]};return t},_firstChild:function(e){e=e?e.firstChild:null;while(e!==null&&e.nodeType!==1){e=e.nextSibling};return e},_nextSibling:function(e){e=e?e.nextSibling:null;while(e!==null&&e.nodeType!==1){e=e.nextSibling};return e},_previousSibling:function(e){e=e?e.previousSibling:null;while(e!==null&&e.nodeType!==1){e=e.previousSibling};return e},get_node:function(t,i){if(t&&t.id){t=t.id};var s;try{if(this._model.data[t]){t=this._model.data[t]}
else if(((s=e(t,this.element)).length||(s=e("#"+t.replace(e.jstree.idregex,"\\$&"),this.element)).length)&&this._model.data[s.closest(".jstree-node").attr("id")]){t=this._model.data[s.closest(".jstree-node").attr("id")]}
else if((s=e(t,this.element)).length&&s.hasClass("jstree")){t=this._model.data["#"]}
else{return!1};if(i){t=t.id==="#"?this.element:e("#"+t.id.replace(e.jstree.idregex,"\\$&"),this.element)};return t}catch(r){return!1}},get_path:function(e,t,i){e=e.parents?e:this.get_node(e);if(!e||e.id==="#"||!e.parents){return!1};var s,n,r=[];r.push(i?e.id:e.text);for(s=0,n=e.parents.length;s<n;s++){r.push(i?e.parents[s]:this.get_text(e.parents[s]))};r=r.reverse().slice(1);return t?r.join(t):r},get_next_dom:function(t,i){var r;t=this.get_node(t,!0);if(t[0]===this.element[0]){r=this._firstChild(this.get_container_ul()[0]);while(r&&r.offsetHeight===0){r=this._nextSibling(r)};return r?e(r):!1};if(!t||!t.length){return!1};if(i){r=t[0];do{r=this._nextSibling(r)}
while(r&&r.offsetHeight===0);return r?e(r):!1};if(t.hasClass("jstree-open")){r=this._firstChild(t.children(".jstree-children")[0]);while(r&&r.offsetHeight===0){r=this._nextSibling(r)};if(r!==null){return e(r)}};r=t[0];do{r=this._nextSibling(r)}
while(r&&r.offsetHeight===0);if(r!==null){return e(r)};return t.parentsUntil(".jstree",".jstree-node").next(".jstree-node:visible").eq(0)},get_prev_dom:function(t,i){var r;t=this.get_node(t,!0);if(t[0]===this.element[0]){r=this.get_container_ul()[0].lastChild;while(r&&r.offsetHeight===0){r=this._previousSibling(r)};return r?e(r):!1};if(!t||!t.length){return!1};if(i){r=t[0];do{r=this._previousSibling(r)}
while(r&&r.offsetHeight===0);return r?e(r):!1};r=t[0];do{r=this._previousSibling(r)}
while(r&&r.offsetHeight===0);if(r!==null){t=e(r);while(t.hasClass("jstree-open")){t=t.children(".jstree-children:eq(0)").children(".jstree-node:visible:last")};return t};r=t[0].parentNode.parentNode;return r&&r.className&&r.className.indexOf("jstree-node")!==-1?e(r):!1},get_parent:function(e){e=this.get_node(e);if(!e||e.id==="#"){return!1};return e.parent},get_children_dom:function(e){e=this.get_node(e,!0);if(e[0]===this.element[0]){return this.get_container_ul().children(".jstree-node")};if(!e||!e.length){return!1};return e.children(".jstree-children").children(".jstree-node")},is_parent:function(e){e=this.get_node(e);return e&&(e.state.loaded===!1||e.children.length>0)},is_loaded:function(e){e=this.get_node(e);return e&&e.state.loaded},is_loading:function(e){e=this.get_node(e);return e&&e.state&&e.state.loading},is_open:function(e){e=this.get_node(e);return e&&e.state.opened},is_closed:function(e){e=this.get_node(e);return e&&this.is_parent(e)&&!e.state.opened},is_leaf:function(e){return!this.is_parent(e)},load_node:function(t,i){var r,a,s,o,n;if(e.isArray(t)){this._load_nodes(t.slice(),i);return!0};t=this.get_node(t);if(!t){if(i){i.call(this,t,!1)};return!1};if(t.state.loaded){t.state.loaded=!1;for(r=0,a=t.children_d.length;r<a;r++){for(s=0,o=t.parents.length;s<o;s++){this._model.data[t.parents[s]].children_d=e.vakata.array_remove_item(this._model.data[t.parents[s]].children_d,t.children_d[r])};if(this._model.data[t.children_d[r]].state.selected){n=!0;this._data.core.selected=e.vakata.array_remove_item(this._data.core.selected,t.children_d[r])};delete this._model.data[t.children_d[r]]};t.children=[];t.children_d=[];if(n){this.trigger("changed",{"action":"load_node","node":t,"selected":this._data.core.selected})}};t.state.loading=!0;this.get_node(t,!0).addClass("jstree-loading");this._load_node(t,e.proxy(function(e){t=this._model.data[t.id];t.state.loading=!1;t.state.loaded=e;var r=this.get_node(t,!0);if(t.state.loaded&&!t.children.length&&r&&r.length&&!r.hasClass("jstree-leaf")){r.removeClass("jstree-closed jstree-open").addClass("jstree-leaf")};r.removeClass("jstree-loading");this.trigger("load_node",{"node":t,"status":e});if(i){i.call(this,t,e)}},this));return!0},_load_nodes:function(e,t,i){var n=!0,o=function(){this._load_nodes(e,t,!0)},a=this._model.data,r,s;for(r=0,s=e.length;r<s;r++){if(a[e[r]]&&(!a[e[r]].state.loaded||!i)){if(!this.is_loading(e[r])){this.load_node(e[r],o)};n=!1}};if(n){if(t&&!t.done){t.call(this,e);t.done=!0}}},_load_node:function(t,i){var r=this.settings.core.data,s;if(!r){if(t.id==="#"){return this._append_html_data(t,this._data.core.original_container_html.clone(!0),function(e){i.call(this,e)})}
else{return i.call(this,!1)}};if(e.isFunction(r)){return r.call(this,t,e.proxy(function(r){if(r===!1){i.call(this,!1)};this[typeof r==="string"?"_append_html_data":"_append_json_data"](t,typeof r==="string"?e(r):r,function(e){i.call(this,e)})},this))};if(typeof r==="object"){if(r.url){r=e.extend(!0,{},r);if(e.isFunction(r.url)){r.url=r.url.call(this,t)};if(e.isFunction(r.data)){r.data=r.data.call(this,t)};return e.ajax(r).done(e.proxy(function(r,s,n){var a=n.getResponseHeader("Content-Type");if(a.indexOf("json")!==-1||typeof r==="object"){return this._append_json_data(t,r,function(e){i.call(this,e)})};if(a.indexOf("html")!==-1||typeof r==="string"){return this._append_html_data(t,e(r),function(e){i.call(this,e)})};this._data.core.last_error={"error":"ajax","plugin":"core","id":"core_04","reason":"Could not load node","data":JSON.stringify({"id":t.id,"xhr":n})};this.settings.core.error.call(this,this._data.core.last_error);return i.call(this,!1)},this)).fail(e.proxy(function(e){i.call(this,!1);this._data.core.last_error={"error":"ajax","plugin":"core","id":"core_04","reason":"Could not load node","data":JSON.stringify({"id":t.id,"xhr":e})};this.settings.core.error.call(this,this._data.core.last_error)},this))};s=(e.isArray(r)||e.isPlainObject(r))?JSON.parse(JSON.stringify(r)):r;if(t.id==="#"){return this._append_json_data(t,s,function(e){i.call(this,e)})}
else{this._data.core.last_error={"error":"nodata","plugin":"core","id":"core_05","reason":"Could not load node","data":JSON.stringify({"id":t.id})};this.settings.core.error.call(this,this._data.core.last_error);return i.call(this,!1)}};if(typeof r==="string"){if(t.id==="#"){return this._append_html_data(t,e(r),function(e){i.call(this,e)})}
else{this._data.core.last_error={"error":"nodata","plugin":"core","id":"core_06","reason":"Could not load node","data":JSON.stringify({"id":t.id})};this.settings.core.error.call(this,this._data.core.last_error);return i.call(this,!1)}};return i.call(this,!1)},_node_changed:function(e){e=this.get_node(e);if(e){this._model.changed.push(e.id)}},_append_html_data:function(t,i,r){t=this.get_node(t);t.children=[];t.children_d=[];var u=i.is("ul")?i.children():i,d=t.id,h=[],a=[],c=this._model.data,s=c[d],f=this._data.core.selected.length,n,o,l;u.each(e.proxy(function(t,i){n=this._parse_model_from_html(e(i),d,s.parents.concat());if(n){h.push(n);a.push(n);if(c[n].children_d.length){a=a.concat(c[n].children_d)}}},this));s.children=h;s.children_d=a;for(o=0,l=s.parents.length;o<l;o++){c[s.parents[o]].children_d=c[s.parents[o]].children_d.concat(a)};this.trigger("model",{"nodes":a,"parent":d});if(d!=="#"){this._node_changed(d);this.redraw()}
else{this.get_container_ul().children(".jstree-initial-node").remove();this.redraw(!0)};if(this._data.core.selected.length!==f){this.trigger("changed",{"action":"model","selected":this._data.core.selected})};r.call(this,!0)},_append_json_data:function(t,i,r,s){t=this.get_node(t);t.children=[];t.children_d=[];if(i.d){i=i.d;if(typeof i==="string"){i=JSON.parse(i)}};if(!e.isArray(i)){i=[i]};var a=null,o={"df":this._model.default_state,"dat":i,"par":t.id,"m":this._model.data,"t_id":this._id,"t_cnt":this._cnt,"sel":this._data.core.selected},c=function(e,t){if(e.data){e=e.data};var s=e.dat,l=e.par,m=[],o=[],h=[],c=e.df,j=e.t_id,u=e.t_cnt,r=e.m,n=r[l],v=e.sel,d,i,a,f,p=function(e,i,s){if(!s){s=[]}
else{s=s.concat()};if(i){s.unshift(i)};var l=e.id.toString(),a,f,d,o,n={id:l,text:e.text||"",icon:e.icon!==t?e.icon:!0,parent:i,parents:s,children:e.children||[],children_d:e.children_d||[],data:e.data,state:{},li_attr:{id:!1},a_attr:{href:"#"},original:!1};for(a in c){if(c.hasOwnProperty(a)){n.state[a]=c[a]}};if(e&&e.data&&e.data.jstree&&e.data.jstree.icon){n.icon=e.data.jstree.icon};if(e&&e.data){n.data=e.data;if(e.data.jstree){for(a in e.data.jstree){if(e.data.jstree.hasOwnProperty(a)){n.state[a]=e.data.jstree[a]}}}};if(e&&typeof e.state==="object"){for(a in e.state){if(e.state.hasOwnProperty(a)){n.state[a]=e.state[a]}}};if(e&&typeof e.li_attr==="object"){for(a in e.li_attr){if(e.li_attr.hasOwnProperty(a)){n.li_attr[a]=e.li_attr[a]}}};if(!n.li_attr.id){n.li_attr.id=l};if(e&&typeof e.a_attr==="object"){for(a in e.a_attr){if(e.a_attr.hasOwnProperty(a)){n.a_attr[a]=e.a_attr[a]}}};if(e&&e.children&&e.children===!0){n.state.loaded=!1;n.children=[];n.children_d=[]};r[n.id]=n;for(a=0,f=n.children.length;a<f;a++){d=p(r[n.children[a]],n.id,s);o=r[d];n.children_d.push(d);if(o.children_d.length){n.children_d=n.children_d.concat(o.children_d)}};delete e.data;delete e.children;r[n.id].original=e;if(n.state.selected){h.push(n.id)};return n.id},g=function(e,i,s){if(!s){s=[]}
else{s=s.concat()};if(i){s.unshift(i)};var o=!1,a,f,l,d,n;do{o="j"+j+"_"+(++u)}
while(r[o]);n={id:!1,text:typeof e==="string"?e:"",icon:typeof e==="object"&&e.icon!==t?e.icon:!0,parent:i,parents:s,children:[],children_d:[],data:null,state:{},li_attr:{id:!1},a_attr:{href:"#"},original:!1};for(a in c){if(c.hasOwnProperty(a)){n.state[a]=c[a]}};if(e&&e.id){n.id=e.id.toString()};if(e&&e.text){n.text=e.text};if(e&&e.data&&e.data.jstree&&e.data.jstree.icon){n.icon=e.data.jstree.icon};if(e&&e.data){n.data=e.data;if(e.data.jstree){for(a in e.data.jstree){if(e.data.jstree.hasOwnProperty(a)){n.state[a]=e.data.jstree[a]}}}};if(e&&typeof e.state==="object"){for(a in e.state){if(e.state.hasOwnProperty(a)){n.state[a]=e.state[a]}}};if(e&&typeof e.li_attr==="object"){for(a in e.li_attr){if(e.li_attr.hasOwnProperty(a)){n.li_attr[a]=e.li_attr[a]}}};if(n.li_attr.id&&!n.id){n.id=n.li_attr.id.toString()};if(!n.id){n.id=o};if(!n.li_attr.id){n.li_attr.id=n.id};if(e&&typeof e.a_attr==="object"){for(a in e.a_attr){if(e.a_attr.hasOwnProperty(a)){n.a_attr[a]=e.a_attr[a]}}};if(e&&e.children&&e.children.length){for(a=0,f=e.children.length;a<f;a++){l=g(e.children[a],n.id,s);d=r[l];n.children.push(l);if(d.children_d.length){n.children_d=n.children_d.concat(d.children_d)}};n.children_d=n.children_d.concat(n.children)};if(e&&e.children&&e.children===!0){n.state.loaded=!1;n.children=[];n.children_d=[]};delete e.data;delete e.children;n.original=e;r[n.id]=n;if(n.state.selected){h.push(n.id)};return n.id};if(s.length&&s[0].id!==t&&s[0].parent!==t){for(i=0,a=s.length;i<a;i++){if(!s[i].children){s[i].children=[]};r[s[i].id.toString()]=s[i]};for(i=0,a=s.length;i<a;i++){r[s[i].parent.toString()].children.push(s[i].id.toString());n.children_d.push(s[i].id.toString())};for(i=0,a=n.children.length;i<a;i++){d=p(r[n.children[i]],l,n.parents.concat());o.push(d);if(r[d].children_d.length){o=o.concat(r[d].children_d)}};for(i=0,a=n.parents.length;i<a;i++){r[n.parents[i]].children_d=r[n.parents[i]].children_d.concat(o)};f={"cnt":u,"mod":r,"sel":v,"par":l,"dpc":o,"add":h}}
else{for(i=0,a=s.length;i<a;i++){d=g(s[i],l,n.parents.concat());if(d){m.push(d);o.push(d);if(r[d].children_d.length){o=o.concat(r[d].children_d)}}};n.children=m;n.children_d=o;for(i=0,a=n.parents.length;i<a;i++){r[n.parents[i]].children_d=r[n.parents[i]].children_d.concat(o)};f={"cnt":u,"mod":r,"sel":v,"par":l,"dpc":o,"add":h}};return f},d=function(t,i){this._cnt=t.cnt;this._model.data=t.mod;if(i){var s,o,c=t.add,n=t.sel,a=this._data.core.selected.slice(),d=this._model.data;if(n.length!==a.length||e.vakata.array_unique(n.concat(a)).length!==n.length){for(s=0,o=n.length;s<o;s++){if(e.inArray(n[s],c)===-1&&e.inArray(n[s],a)===-1){d[n[s]].state.selected=!1}};for(s=0,o=a.length;s<o;s++){if(e.inArray(a[s],n)===-1){d[a[s]].state.selected=!0}}}};if(t.add.length){this._data.core.selected=this._data.core.selected.concat(t.add)};this.trigger("model",{"nodes":t.dpc,"parent":t.par});if(t.par!=="#"){this._node_changed(t.par);this.redraw()}
else{this.redraw(!0)};if(t.add.length){this.trigger("changed",{"action":"model","selected":this._data.core.selected})};r.call(this,!0)};if(this.settings.core.worker&&window.Blob&&window.URL&&window.Worker){try{if(this._wrk===null){this._wrk=window.URL.createObjectURL(new window.Blob(["self.onmessage = "+c.toString().replace(/return ([^;}]+)[\s;}]+$/,"postMessage($1);}")],{type:"text/javascript"}))};if(!this._data.core.working||s){this._data.core.working=!0;a=new window.Worker(this._wrk);a.onmessage=e.proxy(function(e){d.call(this,e.data,!0);try{a.terminate();a=null}catch(t){};if(this._data.core.worker_queue.length){this._append_json_data.apply(this,this._data.core.worker_queue.shift())}
else{this._data.core.working=!1}},this);if(!o.par){if(this._data.core.worker_queue.length){this._append_json_data.apply(this,this._data.core.worker_queue.shift())}
else{this._data.core.working=!1}}
else{a.postMessage(o)}}
else{this._data.core.worker_queue.push([t,i,r,!0])}}catch(n){d.call(this,c(o),!1);if(this._data.core.worker_queue.length){this._append_json_data.apply(this,this._data.core.worker_queue.shift())}
else{this._data.core.working=!1}}}
else{d.call(this,c(o),!1)}},_parse_model_from_html:function(t,i,s){if(!s){s=[]}
else{s=[].concat(s)};if(i){s.unshift(i)};var c,d,l=this._model.data,r={id:!1,text:!1,icon:!0,parent:i,parents:s,children:[],children_d:[],data:null,state:{},li_attr:{id:!1},a_attr:{href:"#"},original:!1},a,n,o;for(a in this._model.default_state){if(this._model.default_state.hasOwnProperty(a)){r.state[a]=this._model.default_state[a]}};n=e.vakata.attributes(t,!0);e.each(n,function(t,i){i=e.trim(i);if(!i.length){return!0};r.li_attr[t]=i;if(t==="id"){r.id=i.toString()}});n=t.children("a").eq(0);if(n.length){n=e.vakata.attributes(n,!0);e.each(n,function(t,i){i=e.trim(i);if(i.length){r.a_attr[t]=i}})};n=t.children("a:eq(0)").length?t.children("a:eq(0)").clone():t.clone();n.children("ins, i, ul").remove();n=n.html();n=e("<div />").html(n);r.text=this.settings.core.force_text?n.text():n.html();n=t.data();r.data=n?e.extend(!0,{},n):null;r.state.opened=t.hasClass("jstree-open");r.state.selected=t.children("a").hasClass("jstree-clicked");r.state.disabled=t.children("a").hasClass("jstree-disabled");if(r.data&&r.data.jstree){for(a in r.data.jstree){if(r.data.jstree.hasOwnProperty(a)){r.state[a]=r.data.jstree[a]}}};n=t.children("a").children(".jstree-themeicon");if(n.length){r.icon=n.hasClass("jstree-themeicon-hidden")?!1:n.attr("rel")};if(r.state.icon){r.icon=r.state.icon};n=t.children("ul").children("li");do{o="j"+this._id+"_"+(++this._cnt)}
while(l[o]);r.id=r.li_attr.id?r.li_attr.id.toString():o;if(n.length){n.each(e.proxy(function(t,i){c=this._parse_model_from_html(e(i),r.id,s);d=this._model.data[c];r.children.push(c);if(d.children_d.length){r.children_d=r.children_d.concat(d.children_d)}},this));r.children_d=r.children_d.concat(r.children)}
else{if(t.hasClass("jstree-closed")){r.state.loaded=!1}};if(r.li_attr["class"]){r.li_attr["class"]=r.li_attr["class"].replace("jstree-closed","").replace("jstree-open","")};if(r.a_attr["class"]){r.a_attr["class"]=r.a_attr["class"].replace("jstree-clicked","").replace("jstree-disabled","")};l[r.id]=r;if(r.state.selected){this._data.core.selected.push(r.id)};return r.id},_parse_model_from_flat_json:function(e,t,r){if(!r){r=[]}
else{r=r.concat()};if(t){r.unshift(t)};var l=e.id.toString(),a=this._model.data,c=this._model.default_state,s,h,d,o,n={id:l,text:e.text||"",icon:e.icon!==i?e.icon:!0,parent:t,parents:r,children:e.children||[],children_d:e.children_d||[],data:e.data,state:{},li_attr:{id:!1},a_attr:{href:"#"},original:!1};for(s in c){if(c.hasOwnProperty(s)){n.state[s]=c[s]}};if(e&&e.data&&e.data.jstree&&e.data.jstree.icon){n.icon=e.data.jstree.icon};if(e&&e.data){n.data=e.data;if(e.data.jstree){for(s in e.data.jstree){if(e.data.jstree.hasOwnProperty(s)){n.state[s]=e.data.jstree[s]}}}};if(e&&typeof e.state==="object"){for(s in e.state){if(e.state.hasOwnProperty(s)){n.state[s]=e.state[s]}}};if(e&&typeof e.li_attr==="object"){for(s in e.li_attr){if(e.li_attr.hasOwnProperty(s)){n.li_attr[s]=e.li_attr[s]}}};if(!n.li_attr.id){n.li_attr.id=l};if(e&&typeof e.a_attr==="object"){for(s in e.a_attr){if(e.a_attr.hasOwnProperty(s)){n.a_attr[s]=e.a_attr[s]}}};if(e&&e.children&&e.children===!0){n.state.loaded=!1;n.children=[];n.children_d=[]};a[n.id]=n;for(s=0,h=n.children.length;s<h;s++){d=this._parse_model_from_flat_json(a[n.children[s]],n.id,r);o=a[d];n.children_d.push(d);if(o.children_d.length){n.children_d=n.children_d.concat(o.children_d)}};delete e.data;delete e.children;a[n.id].original=e;if(n.state.selected){this._data.core.selected.push(n.id)};return n.id},_parse_model_from_json:function(e,t,r){if(!r){r=[]}
else{r=r.concat()};if(t){r.unshift(t)};var l=!1,n,h,c,d,o=this._model.data,a=this._model.default_state,s;do{l="j"+this._id+"_"+(++this._cnt)}
while(o[l]);s={id:!1,text:typeof e==="string"?e:"",icon:typeof e==="object"&&e.icon!==i?e.icon:!0,parent:t,parents:r,children:[],children_d:[],data:null,state:{},li_attr:{id:!1},a_attr:{href:"#"},original:!1};for(n in a){if(a.hasOwnProperty(n)){s.state[n]=a[n]}};if(e&&e.id){s.id=e.id.toString()};if(e&&e.text){s.text=e.text};if(e&&e.data&&e.data.jstree&&e.data.jstree.icon){s.icon=e.data.jstree.icon};if(e&&e.data){s.data=e.data;if(e.data.jstree){for(n in e.data.jstree){if(e.data.jstree.hasOwnProperty(n)){s.state[n]=e.data.jstree[n]}}}};if(e&&typeof e.state==="object"){for(n in e.state){if(e.state.hasOwnProperty(n)){s.state[n]=e.state[n]}}};if(e&&typeof e.li_attr==="object"){for(n in e.li_attr){if(e.li_attr.hasOwnProperty(n)){s.li_attr[n]=e.li_attr[n]}}};if(s.li_attr.id&&!s.id){s.id=s.li_attr.id.toString()};if(!s.id){s.id=l};if(!s.li_attr.id){s.li_attr.id=s.id};if(e&&typeof e.a_attr==="object"){for(n in e.a_attr){if(e.a_attr.hasOwnProperty(n)){s.a_attr[n]=e.a_attr[n]}}};if(e&&e.children&&e.children.length){for(n=0,h=e.children.length;n<h;n++){c=this._parse_model_from_json(e.children[n],s.id,r);d=o[c];s.children.push(c);if(d.children_d.length){s.children_d=s.children_d.concat(d.children_d)}};s.children_d=s.children_d.concat(s.children)};if(e&&e.children&&e.children===!0){s.state.loaded=!1;s.children=[];s.children_d=[]};delete e.data;delete e.children;s.original=e;o[s.id]=s;if(s.state.selected){this._data.core.selected.push(s.id)};return s.id},_redraw:function(){var i=this._model.force_full_redraw?this._model.data["#"].children.concat([]):this._model.changed.concat([]),r=document.createElement("UL"),e,t,n,s=this._data.core.focused;for(t=0,n=i.length;t<n;t++){e=this.redraw_node(i[t],!0,this._model.force_full_redraw);if(e&&this._model.force_full_redraw){r.appendChild(e)}};if(this._model.force_full_redraw){r.className=this.get_container_ul()[0].className;this.element.empty().append(r)};if(s!==null){e=this.get_node(s,!0);if(e&&e.length&&e.children(".jstree-anchor")[0]!==document.activeElement){e.children(".jstree-anchor").focus()}
else{this._data.core.focused=null}};this._model.force_full_redraw=!1;this._model.changed=[];this.trigger("redraw",{"nodes":i})},redraw:function(e){if(e){this._model.force_full_redraw=!0};this._redraw()},redraw_node:function(t,i,s){var r=this.get_node(t),n=!1,u=!1,m=!1,a=!1,o=!1,f=!1,c="",p=document,h=this._model.data,v=!1,g=!1,l=null;if(!r){return!1};if(r.id==="#"){return this.redraw(!0)};i=i||r.children.length===0;t=!document.querySelector?document.getElementById(r.id):this.element[0].querySelector("#"+("0123456789".indexOf(r.id[0])!==-1?"\\3"+r.id[0]+" "+r.id.substr(1).replace(e.jstree.idregex,"\\$&"):r.id.replace(e.jstree.idregex,"\\$&")));if(!t){i=!0;if(!s){n=r.parent!=="#"?e("#"+r.parent.replace(e.jstree.idregex,"\\$&"),this.element)[0]:null;if(n!==null&&(!n||!h[r.parent].state.opened)){return!1};u=e.inArray(r.id,n===null?h["#"].children:h[r.parent].children)}}
else{t=e(t);if(!s){n=t.parent().parent()[0];if(n===this.element[0]){n=null};u=t.index()};if(!i&&r.children.length&&!t.children(".jstree-children").length){i=!0};if(!i){m=t.children(".jstree-children")[0]};g=t.attr("aria-selected");v=t.children(".jstree-anchor")[0]===document.activeElement;t.remove()};t=d.cloneNode(!0);c="jstree-node ";for(a in r.li_attr){if(r.li_attr.hasOwnProperty(a)){if(a==="id"){continue};if(a!=="class"){t.setAttribute(a,r.li_attr[a])}
else{c+=r.li_attr[a]}}};if(g&&g!=="false"){t.setAttribute("aria-selected",!0)};if(r.state.loaded&&!r.children.length){c+=" jstree-leaf"}
else{c+=r.state.opened&&r.state.loaded?" jstree-open":" jstree-closed";t.setAttribute("aria-expanded",(r.state.opened&&r.state.loaded))};if(r.parent!==null&&h[r.parent].children[h[r.parent].children.length-1]===r.id){c+=" jstree-last"};t.id=r.id;t.className=c;c=(r.state.selected?" jstree-clicked":"")+(r.state.disabled?" jstree-disabled":"");for(o in r.a_attr){if(r.a_attr.hasOwnProperty(o)){if(o==="href"&&r.a_attr[o]==="#"){continue};if(o!=="class"){t.childNodes[1].setAttribute(o,r.a_attr[o])}
else{c+=" "+r.a_attr[o]}}};if(c.length){t.childNodes[1].className="jstree-anchor "+c};if((r.icon&&r.icon!==!0)||r.icon===!1){if(r.icon===!1){t.childNodes[1].childNodes[0].className+=" jstree-themeicon-hidden"}
else if(r.icon.indexOf("/")===-1&&r.icon.indexOf(".")===-1){t.childNodes[1].childNodes[0].className+=" "+r.icon+" jstree-themeicon-custom"}
else{t.childNodes[1].childNodes[0].style.backgroundImage="url("+r.icon+")";t.childNodes[1].childNodes[0].style.backgroundPosition="center center";t.childNodes[1].childNodes[0].style.backgroundSize="auto";t.childNodes[1].childNodes[0].className+=" jstree-themeicon-custom"}};if(this.settings.core.force_text){t.childNodes[1].appendChild(p.createTextNode(r.text))}
else{t.childNodes[1].innerHTML+=r.text};if(i&&r.children.length&&r.state.opened&&r.state.loaded){f=p.createElement("UL");f.setAttribute("role","group");f.className="jstree-children";for(a=0,o=r.children.length;a<o;a++){f.appendChild(this.redraw_node(r.children[a],i,!0))};t.appendChild(f)};if(m){t.appendChild(m)};if(!s){if(!n){n=this.element[0]};for(a=0,o=n.childNodes.length;a<o;a++){if(n.childNodes[a]&&n.childNodes[a].className&&n.childNodes[a].className.indexOf("jstree-children")!==-1){l=n.childNodes[a];break}};if(!l){l=p.createElement("UL");l.setAttribute("role","group");l.className="jstree-children";n.appendChild(l)};n=l;if(u<n.childNodes.length){n.insertBefore(t,n.childNodes[u])}
else{n.appendChild(t)};if(v){t.childNodes[1].focus()}};if(r.state.opened&&!r.state.loaded){r.state.opened=!1;setTimeout(e.proxy(function(){this.open_node(r.id,!1,0)},this),0)};return t},open_node:function(t,r,s){var a,d,n,o;if(e.isArray(t)){t=t.slice();for(a=0,d=t.length;a<d;a++){this.open_node(t[a],r,s)};return!0};t=this.get_node(t);if(!t||t.id==="#"){return!1};s=s===i?this.settings.core.animation:s;if(!this.is_closed(t)){if(r){r.call(this,t,!1)};return!1};if(!this.is_loaded(t)){if(this.is_loading(t)){return setTimeout(e.proxy(function(){this.open_node(t,r,s)},this),500)};this.load_node(t,function(e,t){return t?this.open_node(e,r,s):(r?r.call(this,e,!1):!1)})}
else{n=this.get_node(t,!0);o=this;if(n.length){if(t.children.length&&!this._firstChild(n.children(".jstree-children")[0])){t.state.opened=!0;this.redraw_node(t,!0);n=this.get_node(t,!0)};if(!s){this.trigger("before_open",{"node":t});n[0].className=n[0].className.replace("jstree-closed","jstree-open");n[0].setAttribute("aria-expanded",!0)}
else{this.trigger("before_open",{"node":t});n.children(".jstree-children").css("display","none").end().removeClass("jstree-closed").addClass("jstree-open").attr("aria-expanded",!0).children(".jstree-children").stop(!0,!0).slideDown(s,function(){this.style.display="";o.trigger("after_open",{"node":t})})}};t.state.opened=!0;if(r){r.call(this,t,!0)};if(!n.length){this.trigger("before_open",{"node":t})};this.trigger("open_node",{"node":t});if(!s||!n.length){this.trigger("after_open",{"node":t})}}},_open_to:function(t){t=this.get_node(t);if(!t||t.id==="#"){return!1};var i,s,r=t.parents;for(i=0,s=r.length;i<s;i+=1){if(i!=="#"){this.open_node(r[i],!1,0)}};return e("#"+t.id.replace(e.jstree.idregex,"\\$&"),this.element)},close_node:function(t,r){var n,a,o,s;if(e.isArray(t)){t=t.slice();for(n=0,a=t.length;n<a;n++){this.close_node(t[n],r)};return!0};t=this.get_node(t);if(!t||t.id==="#"){return!1};if(this.is_closed(t)){return!1};r=r===i?this.settings.core.animation:r;o=this;s=this.get_node(t,!0);if(s.length){if(!r){s[0].className=s[0].className.replace("jstree-open","jstree-closed");s.attr("aria-expanded",!1).children(".jstree-children").remove()}
else{s.children(".jstree-children").attr("style","display:block !important").end().removeClass("jstree-open").addClass("jstree-closed").attr("aria-expanded",!1).children(".jstree-children").stop(!0,!0).slideUp(r,function(){this.style.display="";s.children(".jstree-children").remove();o.trigger("after_close",{"node":t})})}};t.state.opened=!1;this.trigger("close_node",{"node":t});if(!r||!s.length){this.trigger("after_close",{"node":t})}},toggle_node:function(t){var i,r;if(e.isArray(t)){t=t.slice();for(i=0,r=t.length;i<r;i++){this.toggle_node(t[i])};return!0};if(this.is_closed(t)){return this.open_node(t)};if(this.is_open(t)){return this.close_node(t)}},open_all:function(e,t,i){if(!e){e="#"};e=this.get_node(e);if(!e){return!1};var r=e.id==="#"?this.get_container_ul():this.get_node(e,!0),s,a,n;if(!r.length){for(s=0,a=e.children_d.length;s<a;s++){if(this.is_closed(this._model.data[e.children_d[s]])){this._model.data[e.children_d[s]].state.opened=!0}};return this.trigger("open_all",{"node":e})};i=i||r;n=this;r=this.is_closed(e)?r.find(".jstree-closed").addBack():r.find(".jstree-closed");r.each(function(){n.open_node(this,function(e,r){if(r&&this.is_parent(e)){this.open_all(e,t,i)}},t||0)});if(i.find(".jstree-closed").length===0){this.trigger("open_all",{"node":this.get_node(i)})}},close_all:function(t,i){if(!t){t="#"};t=this.get_node(t);if(!t){return!1};var r=t.id==="#"?this.get_container_ul():this.get_node(t,!0),a=this,s,n;if(!r.length){for(s=0,n=t.children_d.length;s<n;s++){this._model.data[t.children_d[s]].state.opened=!1};return this.trigger("close_all",{"node":t})};r=this.is_open(t)?r.find(".jstree-open").addBack():r.find(".jstree-open");e(r.get().reverse()).each(function(){a.close_node(this,i||0)});this.trigger("close_all",{"node":t})},is_disabled:function(e){e=this.get_node(e);return e&&e.state&&e.state.disabled},enable_node:function(t){var i,r;if(e.isArray(t)){t=t.slice();for(i=0,r=t.length;i<r;i++){this.enable_node(t[i])};return!0};t=this.get_node(t);if(!t||t.id==="#"){return!1};t.state.disabled=!1;this.get_node(t,!0).children(".jstree-anchor").removeClass("jstree-disabled");this.trigger("enable_node",{"node":t})},disable_node:function(t){var i,r;if(e.isArray(t)){t=t.slice();for(i=0,r=t.length;i<r;i++){this.disable_node(t[i])};return!0};t=this.get_node(t);if(!t||t.id==="#"){return!1};t.state.disabled=!0;this.get_node(t,!0).children(".jstree-anchor").addClass("jstree-disabled");this.trigger("disable_node",{"node":t})},activate_node:function(e,t){if(this.is_disabled(e)){return!1};this._data.core.last_clicked=this._data.core.last_clicked&&this._data.core.last_clicked.id!==i?this.get_node(this._data.core.last_clicked.id):null;if(this._data.core.last_clicked&&!this._data.core.last_clicked.state.selected){this._data.core.last_clicked=null};if(!this._data.core.last_clicked&&this._data.core.selected.length){this._data.core.last_clicked=this.get_node(this._data.core.selected[this._data.core.selected.length-1])};if(!this.settings.core.multiple||(!t.metaKey&&!t.ctrlKey&&!t.shiftKey)||(t.shiftKey&&(!this._data.core.last_clicked||!this.get_parent(e)||this.get_parent(e)!==this._data.core.last_clicked.parent))){if(!this.settings.core.multiple&&(t.metaKey||t.ctrlKey||t.shiftKey)&&this.is_selected(e)){this.deselect_node(e,!1,t)}
else{this.deselect_all(!0);this.select_node(e,!1,!1,t);this._data.core.last_clicked=this.get_node(e)}}
else{if(t.shiftKey){var d=this.get_node(e).id,o=this._data.core.last_clicked.id,s=this.get_node(this._data.core.last_clicked.parent).children,n=!1,r,a;for(r=0,a=s.length;r<a;r+=1){if(s[r]===d){n=!n};if(s[r]===o){n=!n};if(n||s[r]===d||s[r]===o){this.select_node(s[r],!1,!1,t)}
else{this.deselect_node(s[r],!1,t)}}}
else{if(!this.is_selected(e)){this.select_node(e,!1,!1,t)}
else{this.deselect_node(e,!1,t)}}};this.trigger("activate_node",{"node":this.get_node(e)})},hover_node:function(e){e=this.get_node(e,!0);if(!e||!e.length||e.children(".jstree-hovered").length){return!1};var t=this.element.find(".jstree-hovered"),i=this.element;if(t&&t.length){this.dehover_node(t)};e.children(".jstree-anchor").addClass("jstree-hovered");this.trigger("hover_node",{"node":this.get_node(e)});setTimeout(function(){i.attr("aria-activedescendant",e[0].id);e.attr("aria-selected",!0)},0)},dehover_node:function(e){e=this.get_node(e,!0);if(!e||!e.length||!e.children(".jstree-hovered").length){return!1};e.attr("aria-selected",!1).children(".jstree-anchor").removeClass("jstree-hovered");this.trigger("dehover_node",{"node":this.get_node(e)})},select_node:function(t,i,r,s){var n,a,o,d;if(e.isArray(t)){t=t.slice();for(a=0,o=t.length;a<o;a++){this.select_node(t[a],i,r,s)};return!0};t=this.get_node(t);if(!t||t.id==="#"){return!1};n=this.get_node(t,!0);if(!t.state.selected){t.state.selected=!0;this._data.core.selected.push(t.id);if(!r){n=this._open_to(t)};if(n&&n.length){n.children(".jstree-anchor").addClass("jstree-clicked")};this.trigger("select_node",{"node":t,"selected":this._data.core.selected,"event":s});if(!i){this.trigger("changed",{"action":"select_node","node":t,"selected":this._data.core.selected,"event":s})}}},deselect_node:function(t,i,r){var s,a,n;if(e.isArray(t)){t=t.slice();for(s=0,a=t.length;s<a;s++){this.deselect_node(t[s],i,r)};return!0};t=this.get_node(t);if(!t||t.id==="#"){return!1};n=this.get_node(t,!0);if(t.state.selected){t.state.selected=!1;this._data.core.selected=e.vakata.array_remove_item(this._data.core.selected,t.id);if(n.length){n.children(".jstree-anchor").removeClass("jstree-clicked")};this.trigger("deselect_node",{"node":t,"selected":this._data.core.selected,"event":r});if(!i){this.trigger("changed",{"action":"deselect_node","node":t,"selected":this._data.core.selected,"event":r})}}},select_all:function(e){var r=this._data.core.selected.concat([]),t,i;this._data.core.selected=this._model.data["#"].children_d.concat();for(t=0,i=this._data.core.selected.length;t<i;t++){if(this._model.data[this._data.core.selected[t]]){this._model.data[this._data.core.selected[t]].state.selected=!0}};this.redraw(!0);this.trigger("select_all",{"selected":this._data.core.selected});if(!e){this.trigger("changed",{"action":"select_all","selected":this._data.core.selected,"old_selection":r})}},deselect_all:function(e){var r=this._data.core.selected.concat([]),t,i;for(t=0,i=this._data.core.selected.length;t<i;t++){if(this._model.data[this._data.core.selected[t]]){this._model.data[this._data.core.selected[t]].state.selected=!1}};this._data.core.selected=[];this.element.find(".jstree-clicked").removeClass("jstree-clicked");this.trigger("deselect_all",{"selected":this._data.core.selected,"node":r});if(!e){this.trigger("changed",{"action":"deselect_all","selected":this._data.core.selected,"old_selection":r})}},is_selected:function(e){e=this.get_node(e);if(!e||e.id==="#"){return!1};return e.state.selected},get_selected:function(t){return t?e.map(this._data.core.selected,e.proxy(function(e){return this.get_node(e)},this)):this._data.core.selected.slice()},get_top_selected:function(t){var r=this.get_selected(!0),s={},i,a,n,o;for(i=0,a=r.length;i<a;i++){s[r[i].id]=r[i]};for(i=0,a=r.length;i<a;i++){for(n=0,o=r[i].children_d.length;n<o;n++){if(s[r[i].children_d[n]]){delete s[r[i].children_d[n]]}}};r=[];for(i in s){if(s.hasOwnProperty(i)){r.push(i)}};return t?e.map(r,e.proxy(function(e){return this.get_node(e)},this)):r},get_bottom_selected:function(t){var s=this.get_selected(!0),r=[],i,n;for(i=0,n=s.length;i<n;i++){if(!s[i].children.length){r.push(s[i].id)}};return t?e.map(r,e.proxy(function(e){return this.get_node(e)},this)):r},get_state:function(){var t={"core":{"open":[],"scroll":{"left":this.element.scrollLeft(),"top":this.element.scrollTop()},
/*!
					'themes' : {
						'name' : this.get_theme(),
						'icons' : this._data.core.themes.icons,
						'dots' : this._data.core.themes.dots
					},
					*/
"selected":[]}},e;for(e in this._model.data){if(this._model.data.hasOwnProperty(e)){if(e!=="#"){if(this._model.data[e].state.opened){t.core.open.push(e)};if(this._model.data[e].state.selected){t.core.selected.push(e)}}}};return t},set_state:function(t,r){if(t){if(t.core){var n,a,s,o;if(t.core.open){if(!e.isArray(t.core.open)){delete t.core.open;this.set_state(t,r);return!1};n=!0;a=!1;s=this;e.each(t.core.open.concat([]),function(i,o){a=s.get_node(o);if(a){if(s.is_loaded(o)){if(s.is_closed(o)){s.open_node(o,!1,0)};if(t&&t.core&&t.core.open){e.vakata.array_remove_item(t.core.open,o)}}
else{if(!s.is_loading(o)){s.open_node(o,e.proxy(function(i,s){if(!s&&t&&t.core&&t.core.open){e.vakata.array_remove_item(t.core.open,i.id)};this.set_state(t,r)},s),0)};n=!1}}});if(n){delete t.core.open;this.set_state(t,r)};return!1};if(t.core.scroll){if(t.core.scroll&&t.core.scroll.left!==i){this.element.scrollLeft(t.core.scroll.left)};if(t.core.scroll&&t.core.scroll.top!==i){this.element.scrollTop(t.core.scroll.top)};delete t.core.scroll;this.set_state(t,r);return!1};
/*!
					if(state.core.themes) {
						if(state.core.themes.name) {
							this.set_theme(state.core.themes.name);
						}
						if(typeof state.core.themes.dots == 'undefined') {
							this[ state.core.themes.dots ? "show_dots" : "hide_dots" ]();
						}
						if(typeof state.core.themes.icons == 'undefined') {
							this[ state.core.themes.icons ? "show_icons" : "hide_icons" ]();
						}
						delete state.core.themes;
						delete state.core.open;
						this.set_state(state, callback);
						return false;
					}
					*/
if(t.core.selected){o=this;this.deselect_all();e.each(t.core.selected,function(e,t){o.select_node(t)});delete t.core.selected;this.set_state(t,r);return!1};if(e.isEmptyObject(t.core)){delete t.core;this.set_state(t,r);return!1}};if(e.isEmptyObject(t)){t=null;if(r){r.call(this)};this.trigger("set_state");return!1};return!0};return!1},refresh:function(t,i){this._data.core.state=i===!0?{}:this.get_state();if(i&&e.isFunction(i)){this._data.core.state=i.call(this,this._data.core.state)};this._cnt=0;this._model.data={"#":{id:"#",parent:null,parents:[],children:[],children_d:[],state:{loaded:!1}}};var r=this.get_container_ul()[0].className;if(!t){this.element.html("<ul class='"+r+"'><li class='jstree-initial-node jstree-loading jstree-leaf jstree-last'><i class='jstree-icon jstree-ocl'></i><a class='jstree-anchor' href='#'><i class='jstree-icon jstree-themeicon-hidden'></i>"+this.get_string("Loading ...")+"</a></li></ul>")};this.load_node("#",function(t,i){if(i){this.get_container_ul()[0].className=r;this.set_state(e.extend(!0,{},this._data.core.state),function(){this.trigger("refresh")})};this._data.core.state=null})},refresh_node:function(t){t=this.get_node(t);if(!t||t.id==="#"){return!1};var i=[],r=[],s=this._data.core.selected.concat([]);r.push(t.id);if(t.state.opened===!0){i.push(t.id)};this.get_node(t,!0).find(".jstree-open").each(function(){i.push(this.id)});this._load_nodes(r,e.proxy(function(e){this.open_node(i,!1,0);this.select_node(this._data.core.selected);this.trigger("refresh_node",{"node":t,"nodes":e})},this))},set_id:function(t,i){t=this.get_node(t);if(!t||t.id==="#"){return!1};var r,n,s=this._model.data;i=i.toString();s[t.parent].children[e.inArray(t.id,s[t.parent].children)]=i;for(r=0,n=t.parents.length;r<n;r++){s[t.parents[r]].children_d[e.inArray(t.id,s[t.parents[r]].children_d)]=i};for(r=0,n=t.children.length;r<n;r++){s[t.children[r]].parent=i};for(r=0,n=t.children_d.length;r<n;r++){s[t.children_d[r]].parents[e.inArray(t.id,s[t.children_d[r]].parents)]=i};r=e.inArray(t.id,this._data.core.selected);if(r!==-1){this._data.core.selected[r]=i};r=this.get_node(t.id,!0);if(r){r.attr("id",i)};delete s[t.id];t.id=i;s[i]=t;return!0},get_text:function(e){e=this.get_node(e);return(!e||e.id==="#")?!1:e.text},set_text:function(t,i){var r,s;if(e.isArray(t)){t=t.slice();for(r=0,s=t.length;r<s;r++){this.set_text(t[r],i)};return!0};t=this.get_node(t);if(!t||t.id==="#"){return!1};t.text=i;if(this.get_node(t,!0).length){this.redraw_node(t.id)};this.trigger("set_text",{"obj":t,"text":i});return!0},get_json:function(t,i,r){t=this.get_node(t||"#");if(!t){return!1};if(i&&i.flat&&!r){r=[]};var s={"id":t.id,"text":t.text,"icon":this.get_icon(t),"li_attr":e.extend(!0,{},t.li_attr),"a_attr":e.extend(!0,{},t.a_attr),"state":{},"data":i&&i.no_data?!1:e.extend(!0,{},t.data)},n,a;if(i&&i.flat){s.parent=t.parent}
else{s.children=[]};if(!i||!i.no_state){for(n in t.state){if(t.state.hasOwnProperty(n)){s.state[n]=t.state[n]}}};if(i&&i.no_id){delete s.id;if(s.li_attr&&s.li_attr.id){delete s.li_attr.id}};if(i&&i.flat&&t.id!=="#"){r.push(s)};if(!i||!i.no_children){for(n=0,a=t.children.length;n<a;n++){if(i&&i.flat){this.get_json(t.children[n],i,r)}
else{s.children.push(this.get_json(t.children[n],i))}}};return i&&i.flat?r:(t.id==="#"?s.children:s)},create_node:function(t,r,s,n,d){if(t===null){t="#"};t=this.get_node(t);if(!t){return!1};s=s===i?"last":s;if(!s.toString().match(/^(before|after)$/)&&!d&&!this.is_loaded(t)){return this.load_node(t,function(){this.create_node(t,r,s,n,!0)})};if(!r){r={"text":this.get_string("New node")}};if(r.text===i){r.text=this.get_string("New node")};var a,c,o,l;if(t.id==="#"){if(s==="before"){s="first"};if(s==="after"){s="last"}};switch(s){case"before":a=this.get_node(t.parent);s=e.inArray(t.id,a.children);t=a;break;case"after":a=this.get_node(t.parent);s=e.inArray(t.id,a.children)+1;t=a;break;case"inside":case"first":s=0;break;case"last":s=t.children.length;break;default:if(!s){s=0};break};if(s>t.children.length){s=t.children.length};if(!r.id){r.id=!0};if(!this.check("create_node",r,t,s)){this.settings.core.error.call(this,this._data.core.last_error);return!1};if(r.id===!0){delete r.id};r=this._parse_model_from_json(r,t.id,t.parents.concat());if(!r){return!1};a=this.get_node(r);c=[];c.push(r);c=c.concat(a.children_d);this.trigger("model",{"nodes":c,"parent":t.id});t.children_d=t.children_d.concat(c);for(o=0,l=t.parents.length;o<l;o++){this._model.data[t.parents[o]].children_d=this._model.data[t.parents[o]].children_d.concat(c)};r=a;a=[];for(o=0,l=t.children.length;o<l;o++){a[o>=s?o+1:o]=t.children[o]};a[s]=r.id;t.children=a;this.redraw_node(t,!0);if(n){n.call(this,this.get_node(r))};this.trigger("create_node",{"node":this.get_node(r),"parent":t.id,"position":s});return r.id},rename_node:function(t,i){var r,n,s;if(e.isArray(t)){t=t.slice();for(r=0,n=t.length;r<n;r++){this.rename_node(t[r],i)};return!0};t=this.get_node(t);if(!t||t.id==="#"){return!1};s=t.text;if(!this.check("rename_node",t,this.get_parent(t),i)){this.settings.core.error.call(this,this._data.core.last_error);return!1};this.set_text(t,i);this.trigger("rename_node",{"node":t,"text":i,"old":s});return!0},delete_node:function(t){var d,h,n,r,s,a,l,i,o,c;if(e.isArray(t)){t=t.slice();for(d=0,h=t.length;d<h;d++){this.delete_node(t[d])};return!0};t=this.get_node(t);if(!t||t.id==="#"){return!1};n=this.get_node(t.parent);r=e.inArray(t.id,n.children);c=!1;if(!this.check("delete_node",t,n,r)){this.settings.core.error.call(this,this._data.core.last_error);return!1};if(r!==-1){n.children=e.vakata.array_remove(n.children,r)};s=t.children_d.concat([]);s.push(t.id);for(i=0,o=s.length;i<o;i++){for(a=0,l=t.parents.length;a<l;a++){r=e.inArray(s[i],this._model.data[t.parents[a]].children_d);if(r!==-1){this._model.data[t.parents[a]].children_d=e.vakata.array_remove(this._model.data[t.parents[a]].children_d,r)}};if(this._model.data[s[i]].state.selected){c=!0;r=e.inArray(s[i],this._data.core.selected);if(r!==-1){this._data.core.selected=e.vakata.array_remove(this._data.core.selected,r)}}};this.trigger("delete_node",{"node":t,"parent":n.id});if(c){this.trigger("changed",{"action":"delete_node","node":t,"selected":this._data.core.selected,"parent":n.id})};for(i=0,o=s.length;i<o;i++){delete this._model.data[s[i]]};this.redraw_node(n,!0);return!0},check:function(t,i,r,s,a){i=i&&i.id?i:this.get_node(i);r=r&&r.id?r:this.get_node(r);var n=t.match(/^move_node|copy_node|create_node$/i)?r:i,o=this.settings.core.check_callback;if(t==="move_node"||t==="copy_node"){if((!a||!a.is_multi)&&(i.id===r.id||e.inArray(i.id,r.children)===s||e.inArray(r.id,i.children_d)!==-1)){this._data.core.last_error={"error":"check","plugin":"core","id":"core_01","reason":"Moving parent inside child","data":JSON.stringify({"chk":t,"pos":s,"obj":i&&i.id?i.id:!1,"par":r&&r.id?r.id:!1})};return!1}};if(n&&n.data){n=n.data};if(n&&n.functions&&(n.functions[t]===!1||n.functions[t]===!0)){if(n.functions[t]===!1){this._data.core.last_error={"error":"check","plugin":"core","id":"core_02","reason":"Node data prevents function: "+t,"data":JSON.stringify({"chk":t,"pos":s,"obj":i&&i.id?i.id:!1,"par":r&&r.id?r.id:!1})}};return n.functions[t]};if(o===!1||(e.isFunction(o)&&o.call(this,t,i,r,s,a)===!1)||(o&&o[t]===!1)){this._data.core.last_error={"error":"check","plugin":"core","id":"core_03","reason":"User config for core.check_callback prevents function: "+t,"data":JSON.stringify({"chk":t,"pos":s,"obj":i&&i.id?i.id:!1,"par":r&&r.id?r.id:!1})};return!1};return!0},last_error:function(){return this._data.core.last_error},move_node:function(t,r,s,c,u){var m,k,f,y,a,o,j,l,d,n,h,p,v,g;r=this.get_node(r);s=s===i?0:s;if(!r){return!1};if(!s.toString().match(/^(before|after)$/)&&!u&&!this.is_loaded(r)){return this.load_node(r,function(){this.move_node(t,r,s,c,!0)})};if(e.isArray(t)){t=t.reverse().slice();for(m=0,k=t.length;m<k;m++){this.move_node(t[m],r,s,c,u)};return!0};t=t&&t.id?t:this.get_node(t);if(!t||t.id==="#"){return!1};f=(t.parent||"#").toString();a=(!s.toString().match(/^(before|after)$/)||r.id==="#")?r:this.get_node(r.parent);o=t.instance?t.instance:(this._model.data[t.id]?this:e.jstree.reference(t.id));j=!o||!o._id||(this._id!==o._id);y=o&&o._id&&f&&o._model.data[f]&&o._model.data[f].children?e.inArray(t.id,o._model.data[f].children):-1;if(j){if(this.copy_node(t,r,s,c,u)){if(o){o.delete_node(t)};return!0};return!1};if(a.id==="#"){if(s==="before"){s="first"};if(s==="after"){s="last"}};switch(s){case"before":s=e.inArray(r.id,a.children);break;case"after":s=e.inArray(r.id,a.children)+1;break;case"inside":case"first":s=0;break;case"last":s=a.children.length;break;default:if(!s){s=0};break};if(s>a.children.length){s=a.children.length};if(!this.check("move_node",t,a,s,{"core":!0,"is_multi":(o&&o._id&&o._id!==this._id),"is_foreign":(!o||!o._id)})){this.settings.core.error.call(this,this._data.core.last_error);return!1};if(t.parent===a.id){l=a.children.concat();d=e.inArray(t.id,l);if(d!==-1){l=e.vakata.array_remove(l,d);if(s>d){s--}};d=[];for(n=0,h=l.length;n<h;n++){d[n>=s?n+1:n]=l[n]};d[s]=t.id;a.children=d;this._node_changed(a.id);this.redraw(a.id==="#")}
else{d=t.children_d.concat();d.push(t.id);for(n=0,h=t.parents.length;n<h;n++){l=[];g=o._model.data[t.parents[n]].children_d;for(p=0,v=g.length;p<v;p++){if(e.inArray(g[p],d)===-1){l.push(g[p])}};o._model.data[t.parents[n]].children_d=l};o._model.data[f].children=e.vakata.array_remove_item(o._model.data[f].children,t.id);for(n=0,h=a.parents.length;n<h;n++){this._model.data[a.parents[n]].children_d=this._model.data[a.parents[n]].children_d.concat(d)};l=[];for(n=0,h=a.children.length;n<h;n++){l[n>=s?n+1:n]=a.children[n]};l[s]=t.id;a.children=l;a.children_d.push(t.id);a.children_d=a.children_d.concat(t.children_d);t.parent=a.id;d=a.parents.concat();d.unshift(a.id);g=t.parents.length;t.parents=d;d=d.concat();for(n=0,h=t.children_d.length;n<h;n++){this._model.data[t.children_d[n]].parents=this._model.data[t.children_d[n]].parents.slice(0,g*-1);Array.prototype.push.apply(this._model.data[t.children_d[n]].parents,d)};this._node_changed(f);this._node_changed(a.id);this.redraw(f==="#"||a.id==="#")};if(c){c.call(this,t,a,s)};this.trigger("move_node",{"node":t,"parent":a.id,"position":s,"old_parent":f,"old_position":y,"is_multi":(o&&o._id&&o._id!==this._id),"is_foreign":(!o||!o._id),"old_instance":o,"new_instance":this});return!0},copy_node:function(t,r,s,o,f){var p,m,c,l,d,g,h,u,n,a,v;r=this.get_node(r);s=s===i?0:s;if(!r){return!1};if(!s.toString().match(/^(before|after)$/)&&!f&&!this.is_loaded(r)){return this.load_node(r,function(){this.copy_node(t,r,s,o,!0)})};if(e.isArray(t)){t=t.reverse().slice();for(p=0,m=t.length;p<m;p++){this.copy_node(t[p],r,s,o,f)};return!0};t=t&&t.id?t:this.get_node(t);if(!t||t.id==="#"){return!1};u=(t.parent||"#").toString();n=(!s.toString().match(/^(before|after)$/)||r.id==="#")?r:this.get_node(r.parent);a=t.instance?t.instance:(this._model.data[t.id]?this:e.jstree.reference(t.id));v=!a||!a._id||(this._id!==a._id);if(n.id==="#"){if(s==="before"){s="first"};if(s==="after"){s="last"}};switch(s){case"before":s=e.inArray(r.id,n.children);break;case"after":s=e.inArray(r.id,n.children)+1;break;case"inside":case"first":s=0;break;case"last":s=n.children.length;break;default:if(!s){s=0};break};if(s>n.children.length){s=n.children.length};if(!this.check("copy_node",t,n,s,{"core":!0,"is_multi":(a&&a._id&&a._id!==this._id),"is_foreign":(!a||!a._id)})){this.settings.core.error.call(this,this._data.core.last_error);return!1};h=a?a.get_json(t,{no_id:!0,no_data:!0,no_state:!0}):t;if(!h){return!1};if(h.id===!0){delete h.id};h=this._parse_model_from_json(h,n.id,n.parents.concat());if(!h){return!1};l=this.get_node(h);if(t&&t.state&&t.state.loaded===!1){l.state.loaded=!1};c=[];c.push(h);c=c.concat(l.children_d);this.trigger("model",{"nodes":c,"parent":n.id});for(d=0,g=n.parents.length;d<g;d++){this._model.data[n.parents[d]].children_d=this._model.data[n.parents[d]].children_d.concat(c)};c=[];for(d=0,g=n.children.length;d<g;d++){c[d>=s?d+1:d]=n.children[d]};c[s]=l.id;n.children=c;n.children_d.push(l.id);n.children_d=n.children_d.concat(l.children_d);this._node_changed(n.id);this.redraw(n.id==="#");if(o){o.call(this,l,n,s)};this.trigger("copy_node",{"node":l,"original":t,"parent":n.id,"position":s,"old_parent":u,"old_position":a&&a._id&&u&&a._model.data[u]&&a._model.data[u].children?e.inArray(t.id,a._model.data[u].children):-1,"is_multi":(a&&a._id&&a._id!==this._id),"is_foreign":(!a||!a._id),"old_instance":a,"new_instance":this});return l.id},cut:function(t){if(!t){t=this._data.core.selected.concat()};if(!e.isArray(t)){t=[t]};if(!t.length){return!1};var a=[],i,r,d;for(r=0,d=t.length;r<d;r++){i=this.get_node(t[r]);if(i&&i.id&&i.id!=="#"){a.push(i)}};if(!a.length){return!1};n=a;o=this;s="move_node";this.trigger("cut",{"node":t})},copy:function(t){if(!t){t=this._data.core.selected.concat()};if(!e.isArray(t)){t=[t]};if(!t.length){return!1};var a=[],i,r,d;for(r=0,d=t.length;r<d;r++){i=this.get_node(t[r]);if(i&&i.id&&i.id!=="#"){a.push(i)}};if(!a.length){return!1};n=a;o=this;s="copy_node";this.trigger("copy",{"node":t})},get_buffer:function(){return{"mode":s,"node":n,"inst":o}},can_paste:function(){return s!==!1&&n!==!1},paste:function(e,t){e=this.get_node(e);if(!e||!s||!s.match(/^(copy_node|move_node)$/)||!n){return!1};if(this[s](n,e,t)){this.trigger("paste",{"parent":e.id,"node":n,"mode":s})};n=!1;s=!1;o=!1},edit:function(i,r){i=this.get_node(i);if(!i){return!1};if(this.settings.core.check_callback===!1){this._data.core.last_error={"error":"check","plugin":"core","id":"core_07","reason":"Could not edit node because of check_callback"};this.settings.core.error.call(this,this._data.core.last_error);return!1};r=typeof r==="string"?r:i.text;this.set_text(i,"");i=this._open_to(i);var l=this._data.core.rtl,c=this.element.width(),s=i.children(".jstree-anchor"),n=e("<span>"),
/*!
				oi = obj.children("i:visible"),
				ai = a.children("i:visible"),
				w1 = oi.width() * oi.length,
				w2 = ai.width() * ai.length,
				*/
t=r,o=e("<div />",{css:{"position":"absolute","top":"-200px","left":(l?"0px":"-1000px"),"visibility":"hidden"}}).appendTo("body"),a=e("<input />",{"value":t,"class":"jstree-rename-input","css":{"padding":"0","border":"1px solid silver","box-sizing":"border-box","display":"inline-block","height":(this._data.core.li_height)+"px","lineHeight":(this._data.core.li_height)+"px","width":"150px"},"blur":e.proxy(function(){var a=n.children(".jstree-rename-input"),r=a.val();if(r===""){r=t};o.remove();n.replaceWith(s);n.remove();this.set_text(i,t);if(this.rename_node(i,e("<div></div>").text(r)[this.settings.core.force_text?"text":"html"]())===!1){this.set_text(i,t)}},this),"keydown":function(e){var i=e.which;if(i===27){this.value=t};if(i===27||i===13||i===37||i===38||i===39||i===40||i===32){e.stopImmediatePropagation()};if(i===27||i===13){e.preventDefault();this.blur()}},"click":function(e){e.stopImmediatePropagation()},"mousedown":function(e){e.stopImmediatePropagation()},"keyup":function(e){a.width(Math.min(o.text("pW"+this.value).width(),c))},"keypress":function(e){if(e.which===13){return!1}}}),d={fontFamily:s.css("fontFamily")||"",fontSize:s.css("fontSize")||"",fontWeight:s.css("fontWeight")||"",fontStyle:s.css("fontStyle")||"",fontStretch:s.css("fontStretch")||"",fontVariant:s.css("fontVariant")||"",letterSpacing:s.css("letterSpacing")||"",wordSpacing:s.css("wordSpacing")||""};n.attr("class",s.attr("class")).append(s.contents().clone()).append(a);s.replaceWith(n);o.css(d);a.css(d).width(Math.min(o.text("pW"+a[0].value).width(),c))[0].select()},set_theme:function(t,i){if(!t){return!1};if(i===!0){var r=this.settings.core.themes.dir;if(!r){r=e.jstree.path+"/themes"};i=r+"/"+t+"/style.css"};if(i&&e.inArray(i,u)===-1){e("head").append("<link rel=\"stylesheet\" href=\""+i+"\" type=\"text/css\" />");u.push(i)};if(this._data.core.themes.name){this.element.removeClass("jstree-"+this._data.core.themes.name)};this._data.core.themes.name=t;this.element.addClass("jstree-"+t);this.element[this.settings.core.themes.responsive?"addClass":"removeClass"]("jstree-"+t+"-responsive");this.trigger("set_theme",{"theme":t})},get_theme:function(){return this._data.core.themes.name},set_theme_variant:function(e){if(this._data.core.themes.variant){this.element.removeClass("jstree-"+this._data.core.themes.name+"-"+this._data.core.themes.variant)};this._data.core.themes.variant=e;if(e){this.element.addClass("jstree-"+this._data.core.themes.name+"-"+this._data.core.themes.variant)}},get_theme_variant:function(){return this._data.core.themes.variant},show_stripes:function(){this._data.core.themes.stripes=!0;this.get_container_ul().addClass("jstree-striped")},hide_stripes:function(){this._data.core.themes.stripes=!1;this.get_container_ul().removeClass("jstree-striped")},toggle_stripes:function(){if(this._data.core.themes.stripes){this.hide_stripes()}
else{this.show_stripes()}},show_dots:function(){this._data.core.themes.dots=!0;this.get_container_ul().removeClass("jstree-no-dots")},hide_dots:function(){this._data.core.themes.dots=!1;this.get_container_ul().addClass("jstree-no-dots")},toggle_dots:function(){if(this._data.core.themes.dots){this.hide_dots()}
else{this.show_dots()}},show_icons:function(){this._data.core.themes.icons=!0;this.get_container_ul().removeClass("jstree-no-icons")},hide_icons:function(){this._data.core.themes.icons=!1;this.get_container_ul().addClass("jstree-no-icons")},toggle_icons:function(){if(this._data.core.themes.icons){this.hide_icons()}
else{this.show_icons()}},set_icon:function(t,i){var n,a,r,s;if(e.isArray(t)){t=t.slice();for(n=0,a=t.length;n<a;n++){this.set_icon(t[n],i)};return!0};t=this.get_node(t);if(!t||t.id==="#"){return!1};s=t.icon;t.icon=i;r=this.get_node(t,!0).children(".jstree-anchor").children(".jstree-themeicon");if(i===!1){this.hide_icon(t)}
else if(i===!0){r.removeClass("jstree-themeicon-custom "+s).css("background","").removeAttr("rel")}
else if(i.indexOf("/")===-1&&i.indexOf(".")===-1){r.removeClass(s).css("background","");r.addClass(i+" jstree-themeicon-custom").attr("rel",i)}
else{r.removeClass(s).css("background","");r.addClass("jstree-themeicon-custom").css("background","url('"+i+"') center center no-repeat").attr("rel",i)};return!0},get_icon:function(e){e=this.get_node(e);return(!e||e.id==="#")?!1:e.icon},hide_icon:function(t){var i,r;if(e.isArray(t)){t=t.slice();for(i=0,r=t.length;i<r;i++){this.hide_icon(t[i])};return!0};t=this.get_node(t);if(!t||t==="#"){return!1};t.icon=!1;this.get_node(t,!0).children(".jstree-anchor").children(".jstree-themeicon").addClass("jstree-themeicon-hidden");return!0},show_icon:function(t){var r,s,i;if(e.isArray(t)){t=t.slice();for(r=0,s=t.length;r<s;r++){this.show_icon(t[r])};return!0};t=this.get_node(t);if(!t||t==="#"){return!1};i=this.get_node(t,!0);t.icon=i.length?i.children(".jstree-anchor").children(".jstree-themeicon").attr("rel"):!0;if(!t.icon){t.icon=!0};i.children(".jstree-anchor").children(".jstree-themeicon").removeClass("jstree-themeicon-hidden");return!0}};e.vakata={};e.vakata.attributes=function(t,i){t=e(t)[0];var r=i?{}:[];if(t&&t.attributes){e.each(t.attributes,function(t,s){if(e.inArray(s.name.toLowerCase(),["style","contenteditable","hasfocus","tabindex"])!==-1){return};if(s.value!==null&&e.trim(s.value)!==""){if(i){r[s.name]=s.value}
else{r.push(s.name)}}})};return r};e.vakata.array_unique=function(e){var s=[],t,i,r;for(t=0,r=e.length;t<r;t++){for(i=0;i<=t;i++){if(e[t]===e[i]){break}};if(i===t){s.push(e[t])}};return s};e.vakata.array_remove=function(e,t,i){var r=e.slice((i||t)+1||e.length);e.length=t<0?e.length+t:t;e.push.apply(e,r);return e};e.vakata.array_remove_item=function(t,i){var r=e.inArray(i,t);return r!==-1?e.vakata.array_remove(t,r):t};var g=document.createElement("I");g.className="jstree-icon jstree-checkbox";e.jstree.defaults.checkbox={visible:!0,three_state:!0,whole_node:!0,keep_selected_style:!0,cascade:"",tie_selection:!0};e.jstree.plugins.checkbox=function(t,i){this.bind=function(){i.bind.call(this);this._data.checkbox.uto=!1;this._data.checkbox.selected=[];if(this.settings.checkbox.three_state){this.settings.checkbox.cascade="up+down+undetermined"};this.element.on("init.jstree",e.proxy(function(){this._data.checkbox.visible=this.settings.checkbox.visible;if(!this.settings.checkbox.keep_selected_style){this.element.addClass("jstree-checkbox-no-clicked")};if(this.settings.checkbox.tie_selection){this.element.addClass("jstree-checkbox-selection")}},this)).on("loading.jstree",e.proxy(function(){this[this._data.checkbox.visible?"show_checkboxes":"hide_checkboxes"]()},this));if(this.settings.checkbox.cascade.indexOf("undetermined")!==-1){this.element.on("changed.jstree uncheck_node.jstree check_node.jstree uncheck_all.jstree check_all.jstree move_node.jstree copy_node.jstree redraw.jstree open_node.jstree",e.proxy(function(){if(this._data.checkbox.uto){clearTimeout(this._data.checkbox.uto)};this._data.checkbox.uto=setTimeout(e.proxy(this._undetermined,this),50)},this))};if(!this.settings.checkbox.tie_selection){this.element.on("model.jstree",e.proxy(function(e,t){var s=this._model.data,a=s[t.parent],r=t.nodes,i,n;for(i=0,n=r.length;i<n;i++){s[r[i]].state.checked=(s[r[i]].original&&s[r[i]].original.state&&s[r[i]].original.state.checked);if(s[r[i]].state.checked){this._data.checkbox.selected.push(r[i])}}},this))};if(this.settings.checkbox.cascade.indexOf("up")!==-1||this.settings.checkbox.cascade.indexOf("down")!==-1){this.element.on("model.jstree",e.proxy(function(t,i){var a=this._model.data,n=a[i.parent],d=i.nodes,l=[],u,r,o,c,f,h,g=this.settings.checkbox.cascade,s=this.settings.checkbox.tie_selection;if(g.indexOf("down")!==-1){if(n.state[s?"selected":"checked"]){for(r=0,o=d.length;r<o;r++){a[d[r]].state[s?"selected":"checked"]=!0};this._data[s?"core":"checkbox"].selected=this._data[s?"core":"checkbox"].selected.concat(d)}
else{for(r=0,o=d.length;r<o;r++){if(a[d[r]].state[s?"selected":"checked"]){for(c=0,f=a[d[r]].children_d.length;c<f;c++){a[a[d[r]].children_d[c]].state[s?"selected":"checked"]=!0};this._data[s?"core":"checkbox"].selected=this._data[s?"core":"checkbox"].selected.concat(a[d[r]].children_d)}}}};if(g.indexOf("up")!==-1){for(r=0,o=n.children_d.length;r<o;r++){if(!a[n.children_d[r]].children.length){l.push(a[n.children_d[r]].parent)}};l=e.vakata.array_unique(l);for(c=0,f=l.length;c<f;c++){n=a[l[c]];while(n&&n.id!=="#"){u=0;for(r=0,o=n.children.length;r<o;r++){u+=a[n.children[r]].state[s?"selected":"checked"]};if(u===o){n.state[s?"selected":"checked"]=!0;this._data[s?"core":"checkbox"].selected.push(n.id);h=this.get_node(n,!0);if(h&&h.length){h.children(".jstree-anchor").addClass(s?"jstree-clicked":"jstree-checked")}}
else{break};n=this.get_node(n.parent)}}};this._data[s?"core":"checkbox"].selected=e.vakata.array_unique(this._data[s?"core":"checkbox"].selected)},this)).on(this.settings.checkbox.tie_selection?"select_node.jstree":"check_node.jstree",e.proxy(function(t,i){var o=i.node,f=this._model.data,s=this.get_node(o.parent),h=this.get_node(o,!0),a,d,l,r,c=this.settings.checkbox.cascade,n=this.settings.checkbox.tie_selection;if(c.indexOf("down")!==-1){this._data[n?"core":"checkbox"].selected=e.vakata.array_unique(this._data[n?"core":"checkbox"].selected.concat(o.children_d));for(a=0,d=o.children_d.length;a<d;a++){r=f[o.children_d[a]];r.state[n?"selected":"checked"]=!0;if(r&&r.original&&r.original.state&&r.original.state.undetermined){r.original.state.undetermined=!1}}};if(c.indexOf("up")!==-1){while(s&&s.id!=="#"){l=0;for(a=0,d=s.children.length;a<d;a++){l+=f[s.children[a]].state[n?"selected":"checked"]};if(l===d){s.state[n?"selected":"checked"]=!0;this._data[n?"core":"checkbox"].selected.push(s.id);r=this.get_node(s,!0);if(r&&r.length){r.children(".jstree-anchor").addClass(n?"jstree-clicked":"jstree-checked")}}
else{break};s=this.get_node(s.parent)}};if(c.indexOf("down")!==-1&&h.length){h.find(".jstree-anchor").addClass(n?"jstree-clicked":"jstree-checked")}},this)).on(this.settings.checkbox.tie_selection?"deselect_all.jstree":"uncheck_all.jstree",e.proxy(function(e,t){var n=this.get_node("#"),a=this._model.data,r,s,i;for(r=0,s=n.children_d.length;r<s;r++){i=a[n.children_d[r]];if(i&&i.original&&i.original.state&&i.original.state.undetermined){i.original.state.undetermined=!1}}},this)).on(this.settings.checkbox.tie_selection?"deselect_node.jstree":"uncheck_node.jstree",e.proxy(function(t,i){var n=i.node,c=this.get_node(n,!0),s,o,r,d=this.settings.checkbox.cascade,a=this.settings.checkbox.tie_selection;if(n&&n.original&&n.original.state&&n.original.state.undetermined){n.original.state.undetermined=!1};if(d.indexOf("down")!==-1){for(s=0,o=n.children_d.length;s<o;s++){r=this._model.data[n.children_d[s]];r.state[a?"selected":"checked"]=!1;if(r&&r.original&&r.original.state&&r.original.state.undetermined){r.original.state.undetermined=!1}}};if(d.indexOf("up")!==-1){for(s=0,o=n.parents.length;s<o;s++){r=this._model.data[n.parents[s]];r.state[a?"selected":"checked"]=!1;if(r&&r.original&&r.original.state&&r.original.state.undetermined){r.original.state.undetermined=!1};r=this.get_node(n.parents[s],!0);if(r&&r.length){r.children(".jstree-anchor").removeClass(a?"jstree-clicked":"jstree-checked")}}};r=[];for(s=0,o=this._data[a?"core":"checkbox"].selected.length;s<o;s++){if((d.indexOf("down")===-1||e.inArray(this._data[a?"core":"checkbox"].selected[s],n.children_d)===-1)&&(d.indexOf("up")===-1||e.inArray(this._data[a?"core":"checkbox"].selected[s],n.parents)===-1)){r.push(this._data[a?"core":"checkbox"].selected[s])}};this._data[a?"core":"checkbox"].selected=e.vakata.array_unique(r);if(d.indexOf("down")!==-1&&c.length){c.find(".jstree-anchor").removeClass(a?"jstree-clicked":"jstree-checked")}},this))};if(this.settings.checkbox.cascade.indexOf("up")!==-1){this.element.on("delete_node.jstree",e.proxy(function(e,t){var i=this.get_node(t.parent),d=this._model.data,n,o,a,r,s=this.settings.checkbox.tie_selection;while(i&&i.id!=="#"){a=0;for(n=0,o=i.children.length;n<o;n++){a+=d[i.children[n]].state[s?"selected":"checked"]};if(a===o){i.state[s?"selected":"checked"]=!0;this._data[s?"core":"checkbox"].selected.push(i.id);r=this.get_node(i,!0);if(r&&r.length){r.children(".jstree-anchor").addClass(s?"jstree-clicked":"jstree-checked")}}
else{break};i=this.get_node(i.parent)}},this)).on("move_node.jstree",e.proxy(function(t,i){var l=i.is_multi,h=i.old_parent,f=this.get_node(i.parent),c=this._model.data,r,o,a,d,n,s=this.settings.checkbox.tie_selection;if(!l){r=this.get_node(h);while(r&&r.id!=="#"){o=0;for(a=0,d=r.children.length;a<d;a++){o+=c[r.children[a]].state[s?"selected":"checked"]};if(o===d){r.state[s?"selected":"checked"]=!0;this._data[s?"core":"checkbox"].selected.push(r.id);n=this.get_node(r,!0);if(n&&n.length){n.children(".jstree-anchor").addClass(s?"jstree-clicked":"jstree-checked")}}
else{break};r=this.get_node(r.parent)}};r=f;while(r&&r.id!=="#"){o=0;for(a=0,d=r.children.length;a<d;a++){o+=c[r.children[a]].state[s?"selected":"checked"]};if(o===d){if(!r.state[s?"selected":"checked"]){r.state[s?"selected":"checked"]=!0;this._data[s?"core":"checkbox"].selected.push(r.id);n=this.get_node(r,!0);if(n&&n.length){n.children(".jstree-anchor").addClass(s?"jstree-clicked":"jstree-checked")}}}
else{if(r.state[s?"selected":"checked"]){r.state[s?"selected":"checked"]=!1;this._data[s?"core":"checkbox"].selected=e.vakata.array_remove_item(this._data[s?"core":"checkbox"].selected,r.id);n=this.get_node(r,!0);if(n&&n.length){n.children(".jstree-anchor").removeClass(s?"jstree-clicked":"jstree-checked")}}
else{break}};r=this.get_node(r.parent)}},this))}};this._undetermined=function(){var t,s,n=this._model.data,a=this.settings.checkbox.tie_selection,r=this._data[a?"core":"checkbox"].selected,i=[],o=this;for(t=0,s=r.length;t<s;t++){if(n[r[t]]&&n[r[t]].parents){i=i.concat(n[r[t]].parents)}};this.element.find(".jstree-closed").not(":has(.jstree-children)").each(function(){var e=o.get_node(this),r;if(!e.state.loaded){if(e.original&&e.original.state&&e.original.state.undetermined&&e.original.state.undetermined===!0){i.push(e.id);i=i.concat(e.parents)}}
else{for(t=0,s=e.children_d.length;t<s;t++){r=n[e.children_d[t]];if(!r.state.loaded&&r.original&&r.original.state&&r.original.state.undetermined&&r.original.state.undetermined===!0){i.push(r.id);i=i.concat(r.parents)}}}});i=e.vakata.array_unique(i);i=e.vakata.array_remove_item(i,"#");this.element.find(".jstree-undetermined").removeClass("jstree-undetermined");for(t=0,s=i.length;t<s;t++){if(!n[i[t]].state[a?"selected":"checked"]){r=this.get_node(i[t],!0);if(r&&r.length){r.children(".jstree-anchor").children(".jstree-checkbox").addClass("jstree-undetermined")}}}};this.redraw_node=function(t,r,s){t=i.redraw_node.call(this,t,r,s);if(t){var n,o,a=null;for(n=0,o=t.childNodes.length;n<o;n++){if(t.childNodes[n]&&t.childNodes[n].className&&t.childNodes[n].className.indexOf("jstree-anchor")!==-1){a=t.childNodes[n];break}};if(a){if(!this.settings.checkbox.tie_selection&&this._model.data[t.id].state.checked){a.className+=" jstree-checked"};a.insertBefore(g.cloneNode(!1),a.childNodes[0])}};if(!s&&this.settings.checkbox.cascade.indexOf("undetermined")!==-1){if(this._data.checkbox.uto){clearTimeout(this._data.checkbox.uto)};this._data.checkbox.uto=setTimeout(e.proxy(this._undetermined,this),50)};return t};this.show_checkboxes=function(){this._data.core.themes.checkboxes=!0;this.get_container_ul().removeClass("jstree-no-checkboxes")};this.hide_checkboxes=function(){this._data.core.themes.checkboxes=!1;this.get_container_ul().addClass("jstree-no-checkboxes")};this.toggle_checkboxes=function(){if(this._data.core.themes.checkboxes){this.hide_checkboxes()}
else{this.show_checkboxes()}};this.is_undetermined=function(t){t=this.get_node(t);var r=this.settings.checkbox.cascade,i,n,a=this.settings.checkbox.tie_selection,o=this._data[a?"core":"checkbox"].selected,s=this._model.data;if(!t||t.state[a?"selected":"checked"]===!0||r.indexOf("undetermined")===-1||(r.indexOf("down")===-1&&r.indexOf("up")===-1)){return!1};if(!t.state.loaded&&t.original.state.undetermined===!0){return!0};for(i=0,n=t.children_d.length;i<n;i++){if(e.inArray(t.children_d[i],o)!==-1||(!s[t.children_d[i]].state.loaded&&s[t.children_d[i]].original.state.undetermined)){return!0}};return!1};this.activate_node=function(t,r){if(this.settings.checkbox.tie_selection&&(this.settings.checkbox.whole_node||e(r.target).hasClass("jstree-checkbox"))){r.ctrlKey=!0};if(this.settings.checkbox.tie_selection||(!this.settings.checkbox.whole_node&&!e(r.target).hasClass("jstree-checkbox"))){return i.activate_node.call(this,t,r)};if(this.is_checked(t)){this.uncheck_node(t,r)}
else{this.check_node(t,r)};this.trigger("activate_node",{"node":this.get_node(t)})};this.check_node=function(t,i){if(this.settings.checkbox.tie_selection){return this.select_node(t,!1,!0,i)};var s,r,n,a;if(e.isArray(t)){t=t.slice();for(r=0,n=t.length;r<n;r++){this.check_node(t[r],i)};return!0};t=this.get_node(t);if(!t||t.id==="#"){return!1};s=this.get_node(t,!0);if(!t.state.checked){t.state.checked=!0;this._data.checkbox.selected.push(t.id);if(s&&s.length){s.children(".jstree-anchor").addClass("jstree-checked")};this.trigger("check_node",{"node":t,"selected":this._data.checkbox.selected,"event":i})}};this.uncheck_node=function(t,i){if(this.settings.checkbox.tie_selection){return this.deselect_node(t,!1,i)};var r,n,s;if(e.isArray(t)){t=t.slice();for(r=0,n=t.length;r<n;r++){this.uncheck_node(t[r],i)};return!0};t=this.get_node(t);if(!t||t.id==="#"){return!1};s=this.get_node(t,!0);if(t.state.checked){t.state.checked=!1;this._data.checkbox.selected=e.vakata.array_remove_item(this._data.checkbox.selected,t.id);if(s.length){s.children(".jstree-anchor").removeClass("jstree-checked")};this.trigger("uncheck_node",{"node":t,"selected":this._data.checkbox.selected,"event":i})}};this.check_all=function(){if(this.settings.checkbox.tie_selection){return this.select_all()};var i=this._data.checkbox.selected.concat([]),e,t;this._data.checkbox.selected=this._model.data["#"].children_d.concat();for(e=0,t=this._data.checkbox.selected.length;e<t;e++){if(this._model.data[this._data.checkbox.selected[e]]){this._model.data[this._data.checkbox.selected[e]].state.checked=!0}};this.redraw(!0);this.trigger("check_all",{"selected":this._data.checkbox.selected})};this.uncheck_all=function(){if(this.settings.checkbox.tie_selection){return this.deselect_all()};var i=this._data.checkbox.selected.concat([]),e,t;for(e=0,t=this._data.checkbox.selected.length;e<t;e++){if(this._model.data[this._data.checkbox.selected[e]]){this._model.data[this._data.checkbox.selected[e]].state.checked=!1}};this._data.checkbox.selected=[];this.element.find(".jstree-checked").removeClass("jstree-checked");this.trigger("uncheck_all",{"selected":this._data.checkbox.selected,"node":i})};this.is_checked=function(e){if(this.settings.checkbox.tie_selection){return this.is_selected(e)};e=this.get_node(e);if(!e||e.id==="#"){return!1};return e.state.checked};this.get_checked=function(t){if(this.settings.checkbox.tie_selection){return this.get_selected(t)};return t?e.map(this._data.checkbox.selected,e.proxy(function(e){return this.get_node(e)},this)):this._data.checkbox.selected};this.get_top_checked=function(t){if(this.settings.checkbox.tie_selection){return this.get_top_selected(t)};var r=this.get_checked(!0),s={},i,a,n,o;for(i=0,a=r.length;i<a;i++){s[r[i].id]=r[i]};for(i=0,a=r.length;i<a;i++){for(n=0,o=r[i].children_d.length;n<o;n++){if(s[r[i].children_d[n]]){delete s[r[i].children_d[n]]}}};r=[];for(i in s){if(s.hasOwnProperty(i)){r.push(i)}};return t?e.map(r,e.proxy(function(e){return this.get_node(e)},this)):r};this.get_bottom_checked=function(t){if(this.settings.checkbox.tie_selection){return this.get_bottom_selected(t)};var s=this.get_checked(!0),r=[],i,n;for(i=0,n=s.length;i<n;i++){if(!s[i].children.length){r.push(s[i].id)}};return t?e.map(r,e.proxy(function(e){return this.get_node(e)},this)):r}};e.jstree.defaults.contextmenu={select_node:!0,show_at_node:!0,items:function(t,i){return{"create":{"separator_before":!1,"separator_after":!0,"_disabled":!1,"label":"Create","action":function(t){var i=e.jstree.reference(t.reference),r=i.get_node(t.reference);i.create_node(r,{},"last",function(e){setTimeout(function(){i.edit(e)},0)})}},"rename":{"separator_before":!1,"separator_after":!1,"_disabled":!1,"label":"Rename","action":function(t){var i=e.jstree.reference(t.reference),r=i.get_node(t.reference);i.edit(r)}},"remove":{"separator_before":!1,"icon":!1,"separator_after":!1,"_disabled":!1,"label":"Delete","action":function(t){var i=e.jstree.reference(t.reference),r=i.get_node(t.reference);if(i.is_selected(r)){i.delete_node(i.get_selected())}
else{i.delete_node(r)}}},"ccp":{"separator_before":!0,"icon":!1,"separator_after":!1,"label":"Edit","action":!1,"submenu":{"cut":{"separator_before":!1,"separator_after":!1,"label":"Cut","action":function(t){var i=e.jstree.reference(t.reference),r=i.get_node(t.reference);if(i.is_selected(r)){i.cut(i.get_selected())}
else{i.cut(r)}}},"copy":{"separator_before":!1,"icon":!1,"separator_after":!1,"label":"Copy","action":function(t){var i=e.jstree.reference(t.reference),r=i.get_node(t.reference);if(i.is_selected(r)){i.copy(i.get_selected())}
else{i.copy(r)}}},"paste":{"separator_before":!1,"icon":!1,"_disabled":function(t){return!e.jstree.reference(t.reference).can_paste()},"separator_after":!1,"label":"Paste","action":function(t){var i=e.jstree.reference(t.reference),r=i.get_node(t.reference);i.paste(r)}}}}}}};e.jstree.plugins.contextmenu=function(t,r){this.bind=function(){r.bind.call(this);var t=0;this.element.on("contextmenu.jstree",".jstree-anchor",e.proxy(function(e){e.preventDefault();t=e.ctrlKey?e.timeStamp:0;if(!this.is_loading(e.currentTarget)){this.show_contextmenu(e.currentTarget,e.pageX,e.pageY,e)}},this)).on("click.jstree",".jstree-anchor",e.proxy(function(i){if(this._data.contextmenu.visible&&(!t||i.timeStamp-t>250)){e.vakata.context.hide()}},this));e(document).on("context_hide.vakata.jstree",e.proxy(function(){this._data.contextmenu.visible=!1},this))};this.teardown=function(){if(this._data.contextmenu.visible){e.vakata.context.hide()};r.teardown.call(this)};this.show_contextmenu=function(t,r,s,n){t=this.get_node(t);if(!t||t.id==="#"){return!1};var d=this.settings.contextmenu,c=this.get_node(t,!0),l=c.children(".jstree-anchor"),o=!1,a=!1;if(d.show_at_node||r===i||s===i){o=l.offset();r=o.left;s=o.top+this._data.core.li_height};if(this.settings.contextmenu.select_node&&!this.is_selected(t)){this.activate_node(t,n)};a=d.items;if(e.isFunction(a)){a=a.call(this,t,e.proxy(function(e){this._show_contextmenu(t,r,s,e)},this))};if(e.isPlainObject(a)){this._show_contextmenu(t,r,s,a)}};this._show_contextmenu=function(t,i,r,s){var a=this.get_node(t,!0),n=a.children(".jstree-anchor");e(document).one("context_show.vakata.jstree",e.proxy(function(t,i){var r="jstree-contextmenu jstree-"+this.get_theme()+"-contextmenu";e(i.element).addClass(r)},this));this._data.contextmenu.visible=!0;e.vakata.context.show(n,{"x":i,"y":r},s);this.trigger("show_contextmenu",{"node":t,"x":i,"y":r})}};(function(e){var i=!1,t={element:!1,reference:!1,position_x:0,position_y:0,items:[],html:"",is_visible:!1};e.vakata.context={settings:{hide_onmouseleave:0,icons:!0},_trigger:function(i){e(document).triggerHandler("context_"+i+".vakata",{"reference":t.reference,"element":t.element,"position":{"x":t.position_x,"y":t.position_y}})},_execute:function(i){i=t.items[i];return i&&(!i._disabled||(e.isFunction(i._disabled)&&!i._disabled({"item":i,"reference":t.reference,"element":t.element})))&&i.action?i.action.call(null,{"item":i,"reference":t.reference,"element":t.element,"position":{"x":t.position_x,"y":t.position_y}}):!1},_parse:function(i,r){if(!i){return!1};if(!r){t.html="";t.items=[]};var s="",a=!1,n;if(r){s+="<ul>"};e.each(i,function(i,r){if(!r){return!0};t.items.push(r);if(!a&&r.separator_before){s+="<li class='vakata-context-separator'><a href='#' "+(e.vakata.context.settings.icons?"":"style=\"margin-left:0px;\"")+">&#160;</a></li>"};a=!1;s+="<li class='"+(r._class||"")+(r._disabled===!0||(e.isFunction(r._disabled)&&r._disabled({"item":r,"reference":t.reference,"element":t.element}))?" vakata-contextmenu-disabled ":"")+"' "+(r.shortcut?" data-shortcut='"+r.shortcut+"' ":"")+">";s+="<a href='#' rel='"+(t.items.length-1)+"'>";if(e.vakata.context.settings.icons){s+="<i ";if(r.icon){if(r.icon.indexOf("/")!==-1||r.icon.indexOf(".")!==-1){s+=" style='background:url(\""+r.icon+"\") center center no-repeat' "}
else{s+=" class='"+r.icon+"' "}};s+="></i><span class='vakata-contextmenu-sep'>&#160;</span>"};s+=(e.isFunction(r.label)?r.label({"item":i,"reference":t.reference,"element":t.element}):r.label)+(r.shortcut?" <span class=\"vakata-contextmenu-shortcut vakata-contextmenu-shortcut-"+r.shortcut+"\">"+(r.shortcut_label||"")+"</span>":"")+"</a>";if(r.submenu){n=e.vakata.context._parse(r.submenu,!0);if(n){s+=n}};s+="</li>";if(r.separator_after){s+="<li class='vakata-context-separator'><a href='#' "+(e.vakata.context.settings.icons?"":"style=\"margin-left:0px;\"")+">&#160;</a></li>";a=!0}});s=s.replace(/<li class\='vakata-context-separator'\><\/li\>$/,"");if(r){s+="</ul>"};if(!r){t.html=s;e.vakata.context._trigger("parse")};return s.length>10?s:!1},_show_submenu:function(t){t=e(t);if(!t.length||!t.children("ul").length){return};var r=t.children("ul"),n=t.offset().left+t.outerWidth(),d=t.offset().top,s=r.width(),c=r.height(),o=e(window).width()+e(window).scrollLeft(),a=e(window).height()+e(window).scrollTop();if(i){t[n-(s+10+t.outerWidth())<0?"addClass":"removeClass"]("vakata-context-left")}
else{t[n+s+10>o?"addClass":"removeClass"]("vakata-context-right")};if(d+c+10>a){r.css("bottom","-1px")};r.show()},show:function(r,s,n){var u,o,a,d,h,f,l,c,g=!0;if(t.element&&t.element.length){t.element.width("")};switch(g){case(!s&&!r):return!1;case(!!s&&!!r):t.reference=r;t.position_x=s.x;t.position_y=s.y;break;case(!s&&!!r):t.reference=r;u=r.offset();t.position_x=u.left+r.outerHeight();t.position_y=u.top;break;case(!!s&&!r):t.position_x=s.x;t.position_y=s.y;break};if(!!r&&!n&&e(r).data("vakata_contextmenu")){n=e(r).data("vakata_contextmenu")};if(e.vakata.context._parse(n)){t.element.html(t.html)};if(t.items.length){t.element.appendTo("body");o=t.element;a=t.position_x;d=t.position_y;h=o.width();f=o.height();l=e(window).width()+e(window).scrollLeft();c=e(window).height()+e(window).scrollTop();if(i){a-=o.outerWidth();if(a<e(window).scrollLeft()+20){a=e(window).scrollLeft()+20}};if(a+h+20>l){a=l-(h+20)};if(d+f+20>c){d=c-(f+20)};t.element.css({"left":a,"top":d}).show().find("a:eq(0)").focus().parent().addClass("vakata-context-hover");t.is_visible=!0;e.vakata.context._trigger("show")}},hide:function(){if(t.is_visible){t.element.hide().find("ul").hide().end().find(":focus").blur().end().detach();t.is_visible=!1;e.vakata.context._trigger("hide")}}};e(function(){i=e("body").css("direction")==="rtl";var r=!1;t.element=e("<ul class='vakata-context'></ul>");t.element.on("mouseenter","li",function(i){i.stopImmediatePropagation();if(e.contains(this,i.relatedTarget)){return};if(r){clearTimeout(r)};t.element.find(".vakata-context-hover").removeClass("vakata-context-hover").end();e(this).siblings().find("ul").hide().end().end().parentsUntil(".vakata-context","li").addBack().addClass("vakata-context-hover");e.vakata.context._show_submenu(this)}).on("mouseleave","li",function(t){if(e.contains(this,t.relatedTarget)){return};e(this).find(".vakata-context-hover").addBack().removeClass("vakata-context-hover")}).on("mouseleave",function(t){e(this).find(".vakata-context-hover").removeClass("vakata-context-hover");if(e.vakata.context.settings.hide_onmouseleave){r=setTimeout((function(t){return function(){e.vakata.context.hide()}}(this)),e.vakata.context.settings.hide_onmouseleave)}}).on("click","a",function(t){t.preventDefault();if(!e(this).blur().parent().hasClass("vakata-context-disabled")&&e.vakata.context._execute(e(this).attr("rel"))!==!1){e.vakata.context.hide()}}).on("keydown","a",function(i){var r=null;switch(i.which){case 13:case 32:i.type="mouseup";i.preventDefault();e(i.currentTarget).trigger(i);break;case 37:if(t.is_visible){t.element.find(".vakata-context-hover").last().parents("li:eq(0)").find("ul").hide().find(".vakata-context-hover").removeClass("vakata-context-hover").end().end().children("a").focus();i.stopImmediatePropagation();i.preventDefault()};break;case 38:if(t.is_visible){r=t.element.find("ul:visible").addBack().last().children(".vakata-context-hover").removeClass("vakata-context-hover").prevAll("li:not(.vakata-context-separator)").first();if(!r.length){r=t.element.find("ul:visible").addBack().last().children("li:not(.vakata-context-separator)").last()};r.addClass("vakata-context-hover").children("a").focus();i.stopImmediatePropagation();i.preventDefault()};break;case 39:if(t.is_visible){t.element.find(".vakata-context-hover").last().children("ul").show().children("li:not(.vakata-context-separator)").removeClass("vakata-context-hover").first().addClass("vakata-context-hover").children("a").focus();i.stopImmediatePropagation();i.preventDefault()};break;case 40:if(t.is_visible){r=t.element.find("ul:visible").addBack().last().children(".vakata-context-hover").removeClass("vakata-context-hover").nextAll("li:not(.vakata-context-separator)").first();if(!r.length){r=t.element.find("ul:visible").addBack().last().children("li:not(.vakata-context-separator)").first()};r.addClass("vakata-context-hover").children("a").focus();i.stopImmediatePropagation();i.preventDefault()};break;case 27:e.vakata.context.hide();i.preventDefault();break;default:break}}).on("keydown",function(e){e.preventDefault();var i=t.element.find(".vakata-contextmenu-shortcut-"+e.which).parent();if(i.parent().not(".vakata-context-disabled")){i.click()}});e(document).on("mousedown.vakata.jstree",function(i){if(t.is_visible&&!e.contains(t.element[0],i.target)){e.vakata.context.hide()}}).on("context_show.vakata.jstree",function(e,r){t.element.find("li:has(ul)").children("a").addClass("vakata-context-parent");if(i){t.element.addClass("vakata-context-rtl").css("direction","rtl")};t.element.find("ul").hide().end()})})}(e));e.jstree.defaults.dnd={copy:!0,open_timeout:500,is_draggable:!0,check_while_dragging:!0,always_copy:!1,inside_pos:0};e.jstree.plugins.dnd=function(t,i){this.bind=function(){i.bind.call(this);this.element.on("mousedown.jstree touchstart.jstree",".jstree-anchor",e.proxy(function(t){var i=this.get_node(t.target),r=this.is_selected(i)?this.get_selected().length:1;if(i&&i.id&&i.id!=="#"&&(t.which===1||t.type==="touchstart")&&(this.settings.dnd.is_draggable===!0||(e.isFunction(this.settings.dnd.is_draggable)&&this.settings.dnd.is_draggable.call(this,(r>1?this.get_selected(!0):[i]))))){this.element.trigger("mousedown.jstree");return e.vakata.dnd.start(t,{"jstree":!0,"origin":this,"obj":this.get_node(i,!0),"nodes":r>1?this.get_selected():[i.id]},"<div id=\"jstree-dnd\" class=\"jstree-"+this.get_theme()+" jstree-"+this.get_theme()+"-"+this.get_theme_variant()+" "+(this.settings.core.themes.responsive?" jstree-dnd-responsive":"")+"\"><i class=\"jstree-icon jstree-er\"></i>"+(r>1?r+" "+this.get_string("nodes"):this.get_text(t.currentTarget,!0))+"<ins class=\"jstree-copy\" style=\"display:none;\">+</ins></div>")}},this))}};e(function(){var t=!1,r=!1,s=!1,i=e("<div id=\"jstree-marker\">&#160;</div>").hide();e(document).on("dnd_start.vakata.jstree",function(e,r){t=!1;if(!r||!r.data||!r.data.jstree){return};i.appendTo("body")}).on("dnd_move.vakata.jstree",function(n,a){if(s){clearTimeout(s)};if(!a||!a.data||!a.data.jstree){return};if(a.event.target.id&&a.event.target.id==="jstree-marker"){return};var o=e.jstree.reference(a.event.target),d=!1,h=!1,y=!1,b,x,f,u,g,p,l,c,k,w,j,C,m,v;if(o&&o._data&&o._data.dnd){i.attr("class","jstree-"+o.get_theme()+(o.settings.core.themes.responsive?" jstree-dnd-responsive":""));a.helper.children().attr("class","jstree-"+o.get_theme()+" jstree-"+o.get_theme()+"-"+o.get_theme_variant()+" "+(o.settings.core.themes.responsive?" jstree-dnd-responsive":"")).find(".jstree-copy:eq(0)")[a.data.origin&&(a.data.origin.settings.dnd.always_copy||(a.data.origin.settings.dnd.copy&&(a.event.metaKey||a.event.ctrlKey)))?"show":"hide"]();if((a.event.target===o.element[0]||a.event.target===o.get_container_ul()[0])&&o.get_container_ul().children().length===0){l=!0;for(c=0,k=a.data.nodes.length;c<k;c++){l=l&&o.check((a.data.origin&&(a.data.origin.settings.dnd.always_copy||(a.data.origin.settings.dnd.copy&&(a.event.metaKey||a.event.ctrlKey)))?"copy_node":"move_node"),(a.data.origin&&a.data.origin!==o?a.data.origin.get_node(a.data.nodes[c]):a.data.nodes[c]),"#","last",{"dnd":!0,"ref":o.get_node("#"),"pos":"i","is_multi":(a.data.origin&&a.data.origin!==o),"is_foreign":(!a.data.origin)});if(!l){break}};if(l){t={"ins":o,"par":"#","pos":"last"};i.hide();a.helper.find(".jstree-icon:eq(0)").removeClass("jstree-er").addClass("jstree-ok");return}}
else{d=e(a.event.target).closest(".jstree-anchor");if(d&&d.length&&d.parent().is(".jstree-closed, .jstree-open, .jstree-leaf")){h=d.offset();y=a.event.pageY-h.top;f=d.height();if(y<f/3){p=["b","i","a"]}
else if(y>f-f/3){p=["a","i","b"]}
else{p=y>f/2?["i","a","b"]:["i","b","a"]};e.each(p,function(n,y){switch(y){case"b":b=h.left-6;x=h.top;u=o.get_parent(d);g=d.parent().index();break;case"i":m=o.settings.dnd.inside_pos;v=o.get_node(d.parent());b=h.left-2;x=h.top+f/2+1;u=v.id;g=m==="first"?0:(m==="last"?v.children.length:Math.min(m,v.children.length));break;case"a":b=h.left-6;x=h.top+f;u=o.get_parent(d);g=d.parent().index()+1;break};
/*!
								// TODO: moving inside, but the node is not yet loaded?
								// the check will work anyway, as when moving the node will be loaded first and checked again
								if(v === 'i' && ins.is_loaded(p)) { }
								*/
l=!0;for(c=0,k=a.data.nodes.length;c<k;c++){w=a.data.origin&&(a.data.origin.settings.dnd.always_copy||(a.data.origin.settings.dnd.copy&&(a.event.metaKey||a.event.ctrlKey)))?"copy_node":"move_node";j=g;if(w==="move_node"&&y==="a"&&(a.data.origin&&a.data.origin===o)&&u===o.get_parent(a.data.nodes[c])){C=o.get_node(u);if(j>e.inArray(a.data.nodes[c],C.children)){j-=1}};l=l&&((o&&o.settings&&o.settings.dnd&&o.settings.dnd.check_while_dragging===!1)||o.check(w,(a.data.origin&&a.data.origin!==o?a.data.origin.get_node(a.data.nodes[c]):a.data.nodes[c]),u,j,{"dnd":!0,"ref":o.get_node(d.parent()),"pos":y,"is_multi":(a.data.origin&&a.data.origin!==o),"is_foreign":(!a.data.origin)}));if(!l){if(o&&o.last_error){r=o.last_error()};break}};if(l){if(y==="i"&&d.parent().is(".jstree-closed")&&o.settings.dnd.open_timeout){s=setTimeout((function(e,t){return function(){e.open_node(t)}}(o,d)),o.settings.dnd.open_timeout)};t={"ins":o,"par":u,"pos":y==="i"&&m==="last"&&g===0&&!o.is_loaded(v)?"last":g};i.css({"left":b+"px","top":x+"px"}).show();a.helper.find(".jstree-icon:eq(0)").removeClass("jstree-er").addClass("jstree-ok");r={};p=!0;return!1}});if(p===!0){return}}}};t=!1;a.helper.find(".jstree-icon").removeClass("jstree-ok").addClass("jstree-er");i.hide()}).on("dnd_scroll.vakata.jstree",function(e,r){if(!r||!r.data||!r.data.jstree){return};i.hide();t=!1;r.helper.find(".jstree-icon:eq(0)").removeClass("jstree-ok").addClass("jstree-er")}).on("dnd_stop.vakata.jstree",function(n,a){if(s){clearTimeout(s)};if(!a||!a.data||!a.data.jstree){return};i.hide().detach();var o,c,d=[];if(t){for(o=0,c=a.data.nodes.length;o<c;o++){d[o]=a.data.origin?a.data.origin.get_node(a.data.nodes[o]):a.data.nodes[o];if(a.data.origin){d[o].instance=a.data.origin}};t.ins[a.data.origin&&(a.data.origin.settings.dnd.always_copy||(a.data.origin.settings.dnd.copy&&(a.event.metaKey||a.event.ctrlKey)))?"copy_node":"move_node"](d,t.par,t.pos);for(o=0,c=d.length;o<c;o++){if(d[o].instance){d[o].instance=null}}}
else{o=e(a.event.target).closest(".jstree");if(o.length&&r&&r.error&&r.error==="check"){o=o.jstree(!0);if(o){o.settings.core.error.call(this,r)}}}}).on("keyup.jstree keydown.jstree",function(t,i){i=e.vakata.dnd._get();if(i&&i.data&&i.data.jstree){i.helper.find(".jstree-copy:eq(0)")[i.data.origin&&(i.data.origin.settings.dnd.always_copy||(i.data.origin.settings.dnd.copy&&(t.metaKey||t.ctrlKey)))?"show":"hide"]()}})});(function(e){var t={element:!1,target:!1,is_down:!1,is_drag:!1,helper:!1,helper_w:0,data:!1,init_x:0,init_y:0,scroll_l:0,scroll_t:0,scroll_e:!1,scroll_i:!1,is_touch:!1};e.vakata.dnd={settings:{scroll_speed:10,scroll_proximity:20,helper_left:5,helper_top:10,threshold:5,threshold_touch:50},_trigger:function(t,i){var r=e.vakata.dnd._get();r.event=i;e(document).triggerHandler("dnd_"+t+".vakata",r)},_get:function(){return{"data":t.data,"element":t.element,"helper":t.helper}},_clean:function(){if(t.helper){t.helper.remove()};if(t.scroll_i){clearInterval(t.scroll_i);t.scroll_i=!1};t={element:!1,target:!1,is_down:!1,is_drag:!1,helper:!1,helper_w:0,data:!1,init_x:0,init_y:0,scroll_l:0,scroll_t:0,scroll_e:!1,scroll_i:!1,is_touch:!1};e(document).off("mousemove.vakata.jstree touchmove.vakata.jstree",e.vakata.dnd.drag);e(document).off("mouseup.vakata.jstree touchend.vakata.jstree",e.vakata.dnd.stop)},_scroll:function(i){if(!t.scroll_e||(!t.scroll_l&&!t.scroll_t)){if(t.scroll_i){clearInterval(t.scroll_i);t.scroll_i=!1};return!1};if(!t.scroll_i){t.scroll_i=setInterval(e.vakata.dnd._scroll,100);return!1};if(i===!0){return!1};var s=t.scroll_e.scrollTop(),r=t.scroll_e.scrollLeft();t.scroll_e.scrollTop(s+t.scroll_t*e.vakata.dnd.settings.scroll_speed);t.scroll_e.scrollLeft(r+t.scroll_l*e.vakata.dnd.settings.scroll_speed);if(s!==t.scroll_e.scrollTop()||r!==t.scroll_e.scrollLeft()){e.vakata.dnd._trigger("scroll",t.scroll_e)}},start:function(i,r,s){if(i.type==="touchstart"&&i.originalEvent&&i.originalEvent.changedTouches&&i.originalEvent.changedTouches[0]){i.pageX=i.originalEvent.changedTouches[0].pageX;i.pageY=i.originalEvent.changedTouches[0].pageY;i.target=document.elementFromPoint(i.originalEvent.changedTouches[0].pageX-window.pageXOffset,i.originalEvent.changedTouches[0].pageY-window.pageYOffset)};if(t.is_drag){e.vakata.dnd.stop({})};try{i.currentTarget.unselectable="on";i.currentTarget.onselectstart=function(){return!1};if(i.currentTarget.style){i.currentTarget.style.MozUserSelect="none"}}catch(n){};t.init_x=i.pageX;t.init_y=i.pageY;t.data=r;t.is_down=!0;t.element=i.currentTarget;t.target=i.target;t.is_touch=i.type==="touchstart";if(s!==!1){t.helper=e("<div id='vakata-dnd'></div>").html(s).css({"display":"block","margin":"0","padding":"0","position":"absolute","top":"-2000px","lineHeight":"16px","zIndex":"10000"})};e(document).on("mousemove.vakata.jstree touchmove.vakata.jstree",e.vakata.dnd.drag);e(document).on("mouseup.vakata.jstree touchend.vakata.jstree",e.vakata.dnd.stop);return!1},drag:function(i){if(i.type==="touchmove"&&i.originalEvent&&i.originalEvent.changedTouches&&i.originalEvent.changedTouches[0]){i.pageX=i.originalEvent.changedTouches[0].pageX;i.pageY=i.originalEvent.changedTouches[0].pageY;i.target=document.elementFromPoint(i.originalEvent.changedTouches[0].pageX-window.pageXOffset,i.originalEvent.changedTouches[0].pageY-window.pageYOffset)};if(!t.is_down){return};if(!t.is_drag){if(Math.abs(i.pageX-t.init_x)>(t.is_touch?e.vakata.dnd.settings.threshold_touch:e.vakata.dnd.settings.threshold)||Math.abs(i.pageY-t.init_y)>(t.is_touch?e.vakata.dnd.settings.threshold_touch:e.vakata.dnd.settings.threshold)){if(t.helper){t.helper.appendTo("body");t.helper_w=t.helper.outerWidth()};t.is_drag=!0;e.vakata.dnd._trigger("start",i)}
else{return}};var n=!1,l=!1,r=!1,c=!1,s=!1,d=!1,f=!1,h=!1,o=!1,a=!1;t.scroll_t=0;t.scroll_l=0;t.scroll_e=!1;e(e(i.target).parentsUntil("body").addBack().get().reverse()).filter(function(){return(/^auto|scroll$/).test(e(this).css("overflow"))&&(this.scrollHeight>this.offsetHeight||this.scrollWidth>this.offsetWidth)}).each(function(){var s=e(this),r=s.offset();if(this.scrollHeight>this.offsetHeight){if(r.top+s.height()-i.pageY<e.vakata.dnd.settings.scroll_proximity){t.scroll_t=1};if(i.pageY-r.top<e.vakata.dnd.settings.scroll_proximity){t.scroll_t=-1}};if(this.scrollWidth>this.offsetWidth){if(r.left+s.width()-i.pageX<e.vakata.dnd.settings.scroll_proximity){t.scroll_l=1};if(i.pageX-r.left<e.vakata.dnd.settings.scroll_proximity){t.scroll_l=-1}};if(t.scroll_t||t.scroll_l){t.scroll_e=e(this);return!1}});if(!t.scroll_e){n=e(document);l=e(window);r=n.height();c=l.height();s=n.width();d=l.width();f=n.scrollTop();h=n.scrollLeft();if(r>c&&i.pageY-f<e.vakata.dnd.settings.scroll_proximity){t.scroll_t=-1};if(r>c&&c-(i.pageY-f)<e.vakata.dnd.settings.scroll_proximity){t.scroll_t=1};if(s>d&&i.pageX-h<e.vakata.dnd.settings.scroll_proximity){t.scroll_l=-1};if(s>d&&d-(i.pageX-h)<e.vakata.dnd.settings.scroll_proximity){t.scroll_l=1};if(t.scroll_t||t.scroll_l){t.scroll_e=n}};if(t.scroll_e){e.vakata.dnd._scroll(!0)};if(t.helper){o=parseInt(i.pageY+e.vakata.dnd.settings.helper_top,10);a=parseInt(i.pageX+e.vakata.dnd.settings.helper_left,10);if(r&&o+25>r){o=r-50};if(s&&a+t.helper_w>s){a=s-(t.helper_w+2)};t.helper.css({left:a+"px",top:o+"px"})};e.vakata.dnd._trigger("move",i);return!1},stop:function(i){if(i.type==="touchend"&&i.originalEvent&&i.originalEvent.changedTouches&&i.originalEvent.changedTouches[0]){i.pageX=i.originalEvent.changedTouches[0].pageX;i.pageY=i.originalEvent.changedTouches[0].pageY;i.target=document.elementFromPoint(i.originalEvent.changedTouches[0].pageX-window.pageXOffset,i.originalEvent.changedTouches[0].pageY-window.pageYOffset)};if(t.is_drag){e.vakata.dnd._trigger("stop",i)}
else{if(i.type==="touchend"&&i.target===t.target){var r=setTimeout(function(){e(i.target).click()},100);e(i.target).one("click",function(){if(r){clearTimeout(r)}})}};e.vakata.dnd._clean();return!1}}}(e));e.jstree.defaults.search={ajax:!1,fuzzy:!1,case_sensitive:!1,show_only_matches:!1,close_opened_onclear:!0,search_leaves_only:!1,search_callback:!1};e.jstree.plugins.search=function(t,i){this.bind=function(){i.bind.call(this);this._data.search.str="";this._data.search.dom=e();this._data.search.res=[];this._data.search.opn=[];this.element.on("before_open.jstree",e.proxy(function(t,i){var n,o,d,s=this._data.search.res,r=[],a=e();if(s&&s.length){this._data.search.dom=e(this.element[0].querySelectorAll("#"+e.map(s,function(t){return"0123456789".indexOf(t[0])!==-1?"\\3"+t[0]+" "+t.substr(1).replace(e.jstree.idregex,"\\$&"):t.replace(e.jstree.idregex,"\\$&")}).join(", #")));this._data.search.dom.children(".jstree-anchor").addClass("jstree-search");if(this.settings.search.show_only_matches&&this._data.search.res.length){for(n=0,o=s.length;n<o;n++){r=r.concat(this.get_node(s[n]).parents)};r=e.vakata.array_remove_item(e.vakata.array_unique(r),"#");a=r.length?e(this.element[0].querySelectorAll("#"+e.map(r,function(t){return"0123456789".indexOf(t[0])!==-1?"\\3"+t[0]+" "+t.substr(1).replace(e.jstree.idregex,"\\$&"):t.replace(e.jstree.idregex,"\\$&")}).join(", #"))):e();this.element.find(".jstree-node").hide().filter(".jstree-last").filter(function(){return this.nextSibling}).removeClass("jstree-last");a=a.add(this._data.search.dom);a.parentsUntil(".jstree").addBack().show().filter(".jstree-children").each(function(){e(this).children(".jstree-node:visible").eq(-1).addClass("jstree-last")})}}},this));if(this.settings.search.show_only_matches){this.element.on("search.jstree",function(t,i){if(i.nodes.length){e(this).find(".jstree-node").hide().filter(".jstree-last").filter(function(){return this.nextSibling}).removeClass("jstree-last");i.nodes.parentsUntil(".jstree").addBack().show().filter(".jstree-children").each(function(){e(this).children(".jstree-node:visible").eq(-1).addClass("jstree-last")})}}).on("clear_search.jstree",function(t,i){if(i.nodes.length){e(this).find(".jstree-node").css("display","").filter(".jstree-last").filter(function(){return this.nextSibling}).removeClass("jstree-last")}})}};this.search=function(t,i){if(t===!1||e.trim(t.toString())===""){return this.clear_search()};t=t.toString();var s=this.settings.search,r=s.ajax?s.ajax:!1,o=null,a=[],n=[],c,d;if(this._data.search.res.length){this.clear_search()};if(!i&&r!==!1){if(e.isFunction(r)){return r.call(this,t,e.proxy(function(i){if(i&&i.d){i=i.d};this._load_nodes(!e.isArray(i)?[]:e.vakata.array_unique(i),function(){this.search(t,!0)},!0)},this))}
else{r=e.extend({},r);if(!r.data){r.data={}};r.data.str=t;return e.ajax(r).fail(e.proxy(function(){this._data.core.last_error={"error":"ajax","plugin":"search","id":"search_01","reason":"Could not load search parents","data":JSON.stringify(r)};this.settings.core.error.call(this,this._data.core.last_error)},this)).done(e.proxy(function(i){if(i&&i.d){i=i.d};this._load_nodes(!e.isArray(i)?[]:e.vakata.array_unique(i),function(){this.search(t,!0)},!0)},this))}};this._data.search.str=t;this._data.search.dom=e();this._data.search.res=[];this._data.search.opn=[];o=new e.vakata.search(t,!0,{caseSensitive:s.case_sensitive,fuzzy:s.fuzzy});e.each(this._model.data,function(e,i){if(i.text&&((s.search_callback&&s.search_callback.call(this,t,i))||(!s.search_callback&&o.search(i.text).isMatch))&&(!s.search_leaves_only||(i.state.loaded&&i.children.length===0))){a.push(e);n=n.concat(i.parents)}});if(a.length){n=e.vakata.array_unique(n);this._search_open(n);this._data.search.dom=e(this.element[0].querySelectorAll("#"+e.map(a,function(t){return"0123456789".indexOf(t[0])!==-1?"\\3"+t[0]+" "+t.substr(1).replace(e.jstree.idregex,"\\$&"):t.replace(e.jstree.idregex,"\\$&")}).join(", #")));this._data.search.res=a;this._data.search.dom.children(".jstree-anchor").addClass("jstree-search")};this.trigger("search",{nodes:this._data.search.dom,str:t,res:this._data.search.res})};this.clear_search=function(){this._data.search.dom.children(".jstree-anchor").removeClass("jstree-search");if(this.settings.search.close_opened_onclear){this.close_node(this._data.search.opn,0)};this.trigger("clear_search",{"nodes":this._data.search.dom,str:this._data.search.str,res:this._data.search.res});this._data.search.str="";this._data.search.res=[];this._data.search.opn=[];this._data.search.dom=e()};this._search_open=function(t){var i=this;e.each(t.concat([]),function(r,s){if(s==="#"){return!0};try{s=e("#"+s.replace(e.jstree.idregex,"\\$&"),i.element)}catch(n){};if(s&&s.length){if(i.is_closed(s)){i._data.search.opn.push(s[0].id);i.open_node(s,function(){i._search_open(t)},0)}}})}};(function(e){e.vakata.search=function(e,t,i){i=i||{};if(i.fuzzy!==!1){i.fuzzy=!0};e=i.caseSensitive?e:e.toLowerCase();var s=i.location||0,d=i.distance||100,l=i.threshold||0.6,r=e.length,c,o,n,a;if(r>32){i.fuzzy=!1};if(i.fuzzy){c=1<<(r-1);o=(function(){var i={},t=0;for(t=0;t<r;t++){i[e.charAt(t)]=0};for(t=0;t<r;t++){i[e.charAt(t)]|=1<<(r-t-1)};return i}());n=function(e,t){var n=e/r,i=Math.abs(s-t);if(!d){return i?1.0:n};return n+(i/d)}};a=function(t){t=i.caseSensitive?t:t.toLowerCase();if(e===t||t.indexOf(e)!==-1){return{isMatch:!0,score:0}};if(!i.fuzzy){return{isMatch:!1,score:1}};var g,a,b=t.length,u=l,d=t.indexOf(e,s),p,h,k=r+b,j,y,v,f,x,m=1,w=[];if(d!==-1){u=Math.min(n(0,d),u);d=t.lastIndexOf(e,s+r);if(d!==-1){u=Math.min(n(0,d),u)}};d=-1;for(g=0;g<r;g++){p=0;h=k;while(p<h){if(n(g,s+h)<=u){p=h}
else{k=h};h=Math.floor((k-p)/2+p)};k=h;y=Math.max(1,s-h+1);v=Math.min(s+h,b)+r;f=new Array(v+2);f[v+1]=(1<<g)-1;for(a=v;a>=y;a--){x=o[t.charAt(a-1)];if(g===0){f[a]=((f[a+1]<<1)|1)&x}
else{f[a]=((f[a+1]<<1)|1)&x|(((j[a+1]|j[a])<<1)|1)|j[a+1]};if(f[a]&c){m=n(g,a-1);if(m<=u){u=m;d=a-1;w.push(d);if(d>s){y=Math.max(1,2*s-d)}
else{break}}}};if(n(g+1,s)>u){break};j=f};return{isMatch:d>=0,score:m}};return t===!0?{"search":a}:a(t)}}(e));e.jstree.defaults.sort=function(e,t){return this.get_text(e)>this.get_text(t)?1:-1};e.jstree.plugins.sort=function(t,i){this.bind=function(){i.bind.call(this);this.element.on("model.jstree",e.proxy(function(e,t){this.sort(t.parent,!0)},this)).on("rename_node.jstree create_node.jstree",e.proxy(function(e,t){this.sort(t.parent||t.node.parent,!1);this.redraw_node(t.parent||t.node.parent,!0)},this)).on("move_node.jstree copy_node.jstree",e.proxy(function(e,t){this.sort(t.parent,!1);this.redraw_node(t.parent,!0)},this))};this.sort=function(t,i){var r,s;t=this.get_node(t);if(t&&t.children&&t.children.length){t.children.sort(e.proxy(this.settings.sort,this));if(i){for(r=0,s=t.children_d.length;r<s;r++){this.sort(t.children_d[r],!1)}}}}};var h=!1;e.jstree.defaults.state={key:"jstree",events:"changed.jstree open_node.jstree close_node.jstree",ttl:!1,filter:!1};e.jstree.plugins.state=function(t,i){this.bind=function(){i.bind.call(this);var t=e.proxy(function(){this.element.on(this.settings.state.events,e.proxy(function(){if(h){clearTimeout(h)};h=setTimeout(e.proxy(function(){this.save_state()},this),100)},this))},this);this.element.on("ready.jstree",e.proxy(function(e,i){this.element.one("restore_state.jstree",t);if(!this.restore_state()){t()}},this))};this.save_state=function(){var t={"state":this.get_state(),"ttl":this.settings.state.ttl,"sec":+(new Date())};e.vakata.storage.set(this.settings.state.key,JSON.stringify(t))};this.restore_state=function(){var t=e.vakata.storage.get(this.settings.state.key);if(!!t){try{t=JSON.parse(t)}catch(i){return!1}};if(!!t&&t.ttl&&t.sec&&+(new Date())-t.sec>t.ttl){return!1};if(!!t&&t.state){t=t.state};if(!!t&&e.isFunction(this.settings.state.filter)){t=this.settings.state.filter.call(this,t)};if(!!t){this.element.one("set_state.jstree",function(i,r){r.instance.trigger("restore_state",{"state":e.extend(!0,{},t)})});this.set_state(t);return!0};return!1};this.clear_state=function(){return e.vakata.storage.del(this.settings.state.key)}};(function(e,t){e.vakata.storage={set:function(e,t){return window.localStorage.setItem(e,t)},get:function(e){return window.localStorage.getItem(e)},del:function(e){return window.localStorage.removeItem(e)}}}(e));e.jstree.defaults.types={"#":{},"default":{}};e.jstree.plugins.types=function(t,r){this.init=function(e,t){var s,n;if(t&&t.types&&t.types["default"]){for(s in t.types){if(s!=="default"&&s!=="#"&&t.types.hasOwnProperty(s)){for(n in t.types["default"]){if(t.types["default"].hasOwnProperty(n)&&t.types[s][n]===i){t.types[s][n]=t.types["default"][n]}}}}};r.init.call(this,e,t);this._model.data["#"].type="#"};this.refresh=function(e,t){r.refresh.call(this,e,t);this._model.data["#"].type="#"};this.bind=function(){this.element.on("model.jstree",e.proxy(function(e,t){var n=this._model.data,s=t.nodes,o=this.settings.types,r,d,a="default";for(r=0,d=s.length;r<d;r++){a="default";if(n[s[r]].original&&n[s[r]].original.type&&o[n[s[r]].original.type]){a=n[s[r]].original.type};if(n[s[r]].data&&n[s[r]].data.jstree&&n[s[r]].data.jstree.type&&o[n[s[r]].data.jstree.type]){a=n[s[r]].data.jstree.type};n[s[r]].type=a;if(n[s[r]].icon===!0&&o[a].icon!==i){n[s[r]].icon=o[a].icon}};n["#"].type="#"},this));r.bind.call(this)};this.get_json=function(t,i,s){var a,d,o=this._model.data,c=i?e.extend(!0,{},i,{no_id:!1}):{},n=r.get_json.call(this,t,c,s);if(n===!1){return!1};if(e.isArray(n)){for(a=0,d=n.length;a<d;a++){n[a].type=n[a].id&&o[n[a].id]&&o[n[a].id].type?o[n[a].id].type:"default";if(i&&i.no_id){delete n[a].id;if(n[a].li_attr&&n[a].li_attr.id){delete n[a].li_attr.id}}}}
else{n.type=n.id&&o[n.id]&&o[n.id].type?o[n.id].type:"default";if(i&&i.no_id){n=this._delete_ids(n)}};return n};this._delete_ids=function(t){if(e.isArray(t)){for(var i=0,r=t.length;i<r;i++){t[i]=this._delete_ids(t[i])};return t};delete t.id;if(t.li_attr&&t.li_attr.id){delete t.li_attr.id};if(t.children&&e.isArray(t.children)){t.children=this._delete_ids(t.children)};return t};this.check=function(t,s,n,a,c){if(r.check.call(this,t,s,n,a,c)===!1){return!1};s=s&&s.id?s:this.get_node(s);n=n&&n.id?n:this.get_node(n);var l=s&&s.id?e.jstree.reference(s.id):null,o,d,h,f;l=l&&l._model&&l._model.data?l._model.data:null;switch(t){case"create_node":case"move_node":case"copy_node":if(t!=="move_node"||e.inArray(s.id,n.children)===-1){o=this.get_rules(n);if(o.max_children!==i&&o.max_children!==-1&&o.max_children===n.children.length){this._data.core.last_error={"error":"check","plugin":"types","id":"types_01","reason":"max_children prevents function: "+t,"data":JSON.stringify({"chk":t,"pos":a,"obj":s&&s.id?s.id:!1,"par":n&&n.id?n.id:!1})};return!1};if(o.valid_children!==i&&o.valid_children!==-1&&e.inArray((s.type||"default"),o.valid_children)===-1){this._data.core.last_error={"error":"check","plugin":"types","id":"types_02","reason":"valid_children prevents function: "+t,"data":JSON.stringify({"chk":t,"pos":a,"obj":s&&s.id?s.id:!1,"par":n&&n.id?n.id:!1})};return!1};if(l&&s.children_d&&s.parents){d=0;for(h=0,f=s.children_d.length;h<f;h++){d=Math.max(d,l[s.children_d[h]].parents.length)};d=d-s.parents.length+1};if(d<=0||d===i){d=1};do{if(o.max_depth!==i&&o.max_depth!==-1&&o.max_depth<d){this._data.core.last_error={"error":"check","plugin":"types","id":"types_03","reason":"max_depth prevents function: "+t,"data":JSON.stringify({"chk":t,"pos":a,"obj":s&&s.id?s.id:!1,"par":n&&n.id?n.id:!1})};return!1};n=this.get_node(n.parent);o=this.get_rules(n);d++}
while(n);};break};return!0};this.get_rules=function(e){e=this.get_node(e);if(!e){return!1};var t=this.get_type(e,!0);if(t.max_depth===i){t.max_depth=-1};if(t.max_children===i){t.max_children=-1};if(t.valid_children===i){t.valid_children=-1};return t};this.get_type=function(t,i){t=this.get_node(t);return(!t)?!1:(i?e.extend({"type":t.type},this.settings.types[t.type]):t.type)};this.set_type=function(t,r){var s,a,d,n,o;if(e.isArray(t)){t=t.slice();for(a=0,d=t.length;a<d;a++){this.set_type(t[a],r)};return!0};s=this.settings.types;t=this.get_node(t);if(!s[r]||!t){return!1};n=t.type;o=this.get_icon(t);t.type=r;if(o===!0||(s[n]&&s[n].icon&&o===s[n].icon)){this.set_icon(t,s[r].icon!==i?s[r].icon:!0)};return!0}};e.jstree.defaults.unique={case_sensitive:!1,duplicate:function(e,t){return e+" ("+t+")"}};e.jstree.plugins.unique=function(t,r){this.check=function(t,i,s,a,d){if(r.check.call(this,t,i,s,a,d)===!1){return!1};i=i&&i.id?i:this.get_node(i);s=s&&s.id?s:this.get_node(s);if(!s||!s.children){return!0};var o=t==="rename_node"?a:i.text,c=[],l=this.settings.unique.case_sensitive,f=this._model.data,n,h;for(n=0,h=s.children.length;n<h;n++){c.push(l?f[s.children[n]].text:f[s.children[n]].text.toLowerCase())};if(!l){o=o.toLowerCase()};switch(t){case"delete_node":return!0;case"rename_node":n=(e.inArray(o,c)===-1||(i.text&&i.text[l?"toString":"toLowerCase"]()===o));if(!n){this._data.core.last_error={"error":"check","plugin":"unique","id":"unique_01","reason":"Child with name "+o+" already exists. Preventing: "+t,"data":JSON.stringify({"chk":t,"pos":a,"obj":i&&i.id?i.id:!1,"par":s&&s.id?s.id:!1})}};return n;case"create_node":n=(e.inArray(o,c)===-1);if(!n){this._data.core.last_error={"error":"check","plugin":"unique","id":"unique_04","reason":"Child with name "+o+" already exists. Preventing: "+t,"data":JSON.stringify({"chk":t,"pos":a,"obj":i&&i.id?i.id:!1,"par":s&&s.id?s.id:!1})}};return n;case"copy_node":n=(e.inArray(o,c)===-1);if(!n){this._data.core.last_error={"error":"check","plugin":"unique","id":"unique_02","reason":"Child with name "+o+" already exists. Preventing: "+t,"data":JSON.stringify({"chk":t,"pos":a,"obj":i&&i.id?i.id:!1,"par":s&&s.id?s.id:!1})}};return n;case"move_node":n=(i.parent===s.id||e.inArray(o,c)===-1);if(!n){this._data.core.last_error={"error":"check","plugin":"unique","id":"unique_03","reason":"Child with name "+o+" already exists. Preventing: "+t,"data":JSON.stringify({"chk":t,"pos":a,"obj":i&&i.id?i.id:!1,"par":s&&s.id?s.id:!1})}};return n};return!0};this.create_node=function(t,s,n,a,o){if(!s||s.text===i){if(t===null){t="#"};t=this.get_node(t);if(!t){return r.create_node.call(this,t,s,n,a,o)};n=n===i?"last":n;if(!n.toString().match(/^(before|after)$/)&&!o&&!this.is_loaded(t)){return r.create_node.call(this,t,s,n,a,o)};if(!s){s={}};var g,c,l,d,u,f=this._model.data,h=this.settings.unique.case_sensitive,p=this.settings.unique.duplicate;c=g=this.get_string("New node");l=[];for(d=0,u=t.children.length;d<u;d++){l.push(h?f[t.children[d]].text:f[t.children[d]].text.toLowerCase())};d=1;while(e.inArray(h?c:c.toLowerCase(),l)!==-1){c=p.call(this,g,(++d)).toString()};s.text=c};return r.create_node.call(this,t,s,n,a,o)}};var a=document.createElement("DIV");a.setAttribute("unselectable","on");a.className="jstree-wholerow";a.innerHTML="&#160;";e.jstree.plugins.wholerow=function(t,i){this.bind=function(){i.bind.call(this);this.element.on("ready.jstree set_state.jstree",e.proxy(function(){this.hide_dots()},this)).on("init.jstree loading.jstree ready.jstree",e.proxy(function(){this.get_container_ul().addClass("jstree-wholerow-ul")},this)).on("deselect_all.jstree",e.proxy(function(e,t){this.element.find(".jstree-wholerow-clicked").removeClass("jstree-wholerow-clicked")},this)).on("changed.jstree",e.proxy(function(e,t){this.element.find(".jstree-wholerow-clicked").removeClass("jstree-wholerow-clicked");var r=!1,i,s;for(i=0,s=t.selected.length;i<s;i++){r=this.get_node(t.selected[i],!0);if(r&&r.length){r.children(".jstree-wholerow").addClass("jstree-wholerow-clicked")}}},this)).on("open_node.jstree",e.proxy(function(e,t){this.get_node(t.node,!0).find(".jstree-clicked").parent().children(".jstree-wholerow").addClass("jstree-wholerow-clicked")},this)).on("hover_node.jstree dehover_node.jstree",e.proxy(function(e,t){this.get_node(t.node,!0).children(".jstree-wholerow")[e.type==="hover_node"?"addClass":"removeClass"]("jstree-wholerow-hovered")},this)).on("contextmenu.jstree",".jstree-wholerow",e.proxy(function(t){t.preventDefault();var i=e.Event("contextmenu",{metaKey:t.metaKey,ctrlKey:t.ctrlKey,altKey:t.altKey,shiftKey:t.shiftKey,pageX:t.pageX,pageY:t.pageY});e(t.currentTarget).closest(".jstree-node").children(".jstree-anchor:eq(0)").trigger(i)},this)).on("click.jstree",".jstree-wholerow",function(t){t.stopImmediatePropagation();var i=e.Event("click",{metaKey:t.metaKey,ctrlKey:t.ctrlKey,altKey:t.altKey,shiftKey:t.shiftKey});e(t.currentTarget).closest(".jstree-node").children(".jstree-anchor:eq(0)").trigger(i).focus()}).on("click.jstree",".jstree-leaf > .jstree-ocl",e.proxy(function(t){t.stopImmediatePropagation();var i=e.Event("click",{metaKey:t.metaKey,ctrlKey:t.ctrlKey,altKey:t.altKey,shiftKey:t.shiftKey});e(t.currentTarget).closest(".jstree-node").children(".jstree-anchor:eq(0)").trigger(i).focus()},this)).on("mouseover.jstree",".jstree-wholerow, .jstree-icon",e.proxy(function(e){e.stopImmediatePropagation();this.hover_node(e.currentTarget);return!1},this)).on("mouseleave.jstree",".jstree-node",e.proxy(function(e){this.dehover_node(e.currentTarget)},this))};this.teardown=function(){if(this.settings.wholerow){this.element.find(".jstree-wholerow").remove()};i.teardown.call(this)};this.redraw_node=function(t,r,s){t=i.redraw_node.call(this,t,r,s);if(t){var n=a.cloneNode(!0);if(e.inArray(t.id,this._data.core.selected)!==-1){n.className+=" jstree-wholerow-clicked"};t.insertBefore(n,t.childNodes[0])};return t}};(function(e){if(document.registerElement){var i=Object.create(HTMLElement.prototype);i.createdCallback=function(){var i={core:{},plugins:[]},t;for(t in e.jstree.plugins){if(e.jstree.plugins.hasOwnProperty(t)&&this.attributes[t]){i.plugins.push(t);if(this.getAttribute(t)&&JSON.parse(this.getAttribute(t))){i[t]=JSON.parse(this.getAttribute(t))}}};for(t in e.jstree.defaults.core){if(e.jstree.defaults.core.hasOwnProperty(t)&&this.attributes[t]){i.core[t]=JSON.parse(this.getAttribute(t))||this.getAttribute(t)}};jQuery(this).jstree(i)};try{document.registerElement("vakata-jstree",{prototype:i})}catch(t){}}}(jQuery))}));